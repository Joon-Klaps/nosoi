<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spread of a pathogen in a continuous space • nosoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spread of a pathogen in a continuous space">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nosoi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nosoi.html">
    <span class="fas fa fas fa-play-circle"></span>
     
    Getting started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Simulation set up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-file"></span>
     
    Visualise &amp; summarise
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/output.html">nosoi output</a>
    </li>
    <li>
      <a href="../articles/examples/viz.html">Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-file"></span>
     
    Pathogen examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/examples/ebola.html">Spread of Ebola-like virus in a continuous space</a>
    </li>
    <li>
      <a href="../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/examples/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/examples/ebola.html">Spread of an Ebola-like virus in a continuous space</a>
    </li>
    <li>
      <a href="../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence variation</a>
    </li>
    <li>
      <a href="../articles/examples/viz.html">Visualization tips</a>
    </li>
    <li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/output.html">`nosoi` output and summarisation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/slequime/nosoi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Spread of a pathogen in a continuous space</h1>
                        <h4 class="author">Sebastian Lequime</h4>
            
            <h4 class="date">2019-07-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slequime/nosoi/blob/master/vignettes/continuous.Rmd"><code>vignettes/continuous.Rmd</code></a></small>
      <div class="hidden name"><code>continuous.Rmd</code></div>

    </div>

    
    
<p>Aside from the simple simulation set up, explored in <a href="none.html">another tutorial</a>, where hosts are “not structured”, <code>nosoi</code> can take into account a population structured either in discrete states or in a continuous space. We will here focus on a continuous space structuration (for the discrete structuration, see <a href="discrete.html">this tutorial</a>).</p>
<p>The continuous space is intended to allow the simulation to take place in a geographical context where hosts can move on a map, and may be influenced by heterogeneously distributed variables (environemental for example) on said map. This tutorial will focus on setting up a <code>nosoi</code> simulation for a pathogen whose spread occurs in continuous space.</p>
<div id="structure-of-the-population" class="section level1">
<h1 class="hasAnchor">
<a href="#structure-of-the-population" class="anchor"></a>Structure of the population</h1>
<div id="continuous-space" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-space" class="anchor"></a>Continuous space</h2>
<p>In the continuous space, the simulation will take place on a map defined by its coordinates. This map is actually a raster, called <code>structure.raster</code>, that also holds an environmental value of interest that may influence the epidemic process. Areas were hosts cannot move (water, unaccessible areas, etc) must be defined by the value <code>NA</code>.</p>
<p>Here, we will generate a random raster for the purpose of this tutorial, but you can use a “real” world raster and simulate your epidemic on it ( <a href="example/ebola.html">see this example</a> ).</p>
<details><p><summary>Code used to create the random raster used in this tutorial</summary></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(raster)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">860</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">test.raster &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/raster">raster</a></span>(<span class="dt">nrows=</span><span class="dv">100</span>, <span class="dt">ncols=</span><span class="dv">100</span>, <span class="dt">xmn=</span><span class="op">-</span><span class="dv">50</span>, <span class="dt">xmx=</span><span class="dv">50</span>, <span class="dt">ymn=</span><span class="op">-</span><span class="dv">50</span>,<span class="dt">ymx=</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">test.raster[] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">10000</span>, <span class="dv">-80</span>, <span class="dv">150</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">test.raster &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/focal">focal</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/raster/topics/focal">focal</a></span>(test.raster, <span class="dt">w=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>), mean), <span class="dt">w=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">5</span>), mean)</a></code></pre></div>
</details><p><img src="continuous_files/figure-html/RasterCode2-1.png" width="700"></p>
</div>
<div id="movement-kernel" class="section level2">
<h2 class="hasAnchor">
<a href="#movement-kernel" class="anchor"></a>Movement kernel</h2>
<p>Movements in <code>nosoi</code> are basically described by a random walk (Brownian motion), that can be attracted by the underlying environmental variable (<code>attracted.by.raster</code>). In any case, the movement cannot land into areas out of the raster nor into areas of the raster with no value (<code>NA</code>).</p>
<p>The user provides a core function <code>sdMove</code> that give the standard deviation of this Brownian motion. This function, <a href="nosoi.html#setting-up-the-core-functions">like the other core functions</a>, can be dependent of time since infection, absolute time of the simulation, location (value of the environmental variable) or individual-based parameters. This standard deviation is in your coordinate space, so the actual distance travelled by the host may actually vary according to your space.</p>
<p>In the case where hosts are attracted by the raster, hosts will tend to go to positions with high environmental values. Internally, once a new position is proposed, its environmental value is extracted and normalized (against the highest environmental value). This normalized number represents its probability of acceptance. Up to 30 draws can be made until one is accepted (by default the 30<span class="math inline">\(^{th}\)</span> move is always accepted; this value was empirically set to allow enough exploration without being stuck in a time consumming search).</p>
<p>The figure below shows a movement on a simple gradient raster, with or without an attraction (<code>sdMove</code> is a constant fixed at 0.01, time is 1000 units of time, maximum value of the environmental variable is 300). The red point represents the starting position.</p>
<p><img src="continuous_files/figure-html/RW-1-1.png" width="700"></p>
</div>
</div>
<div id="setting-up-the-simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-up-the-simulation" class="anchor"></a>Setting up the simulation</h1>
<p>The wrapper function <code>nosoiSim</code> requires all the arguments that will be passed down to the simulator, in the case of this tutorial <code>singleContinuous</code> (for “single host, continuous space”). We thus start by providing the options <code>type="single"</code> and <code>popStructure="continuous"</code> to set up the analysis:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">popStructure=</span><span class="st">"continuous"</span>, ...)</a></code></pre></div>
<p>This simulation type takes several arguments or options to be able to run, namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected</code></li>
<li><code>init.individuals</code></li>
<li><code>init.structure</code></li>
<li><code>structure.raster</code></li>
<li>
<code>pExit</code> with <code>param.pExit</code>, <code>timeDep.pExit</code>, <code>diff.pExit</code> and <code>hostCount.pExit</code>
</li>
<li>
<code>pMove</code> with <code>param.pMove</code>, <code>timeDep.pMove</code>, <code>diff.pMove</code> and <code>hostCount.pMove</code>
</li>
<li>
<code>sdMove</code> with <code>param.sdMove</code>, <code>timeDep.sdMove</code>, <code>diff.sdMove</code> and <code>hostCount.sdMove</code>
</li>
<li><code>attracted.by.raster</code></li>
<li>
<code>nContact</code> with <code>param.nContact</code>, <code>timeDep.nContact</code>, <code>diff.nContact</code> and <code>hostCount.nContact</code>
</li>
<li>
<code>pTrans</code> with <code>param.pTrans</code>, <code>timeDep.pTrans</code>, <code>diff.pTrans</code> and <code>hostCount.pTrans</code>
</li>
<li><code>prefix.host.A</code></li>
<li><code>print.progress</code></li>
<li><code>print.step</code></li>
</ul>
<p>All the <code>param</code> elements provide individual-level parameters to be taken into account, while the <code>timeDep</code> elements inform the simulator if the “absolute” simulation time should be taken into account. The <code>diff</code> elements inform the simulator if there is a differential probability according to the state the host is currently in, and the <code>hostCount</code> elements inform the simulator if the number of host in each raster cell (based on the environmental raster provided) has to be taken into account. All parameters must be provided, although <code>timeDep</code>, <code>diff</code> and <code>hostCount</code> have default values set to <code>FALSE</code>; if you do not want to use these options, then you do not have to explicitly provide a value.</p>
<div id="general-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#general-parameters" class="anchor"></a>General parameters</h2>
<p><code>length.sim</code>, <code>max.infected</code> and <code>init.individuals</code> are general parameters that define the simulation. <code>length.sim</code> is the maximum number of time units (e.g. days, months, years, or another time unit of choice) during which the simulation will be run, whereas <code>max.infected</code> is the maximum number of individuals that can be infected during the simulation. <code>init.individuals</code> and <code>init.structure</code> are the “seeding parameters” with which to start the simulation. <code>init.individuals</code> defines the number of individuals (starting at 1, should be an integer) that will start a transmission chain and <code>init.structure</code> their starting location (as a vector of two coordinates, x and y) in the continuous space (has to be the same starting location for all starting individuals). Keep in mind that you will have as many transmission chains as initial individuals, which is equivalent as launching two independent nosoi simulations. The location provided in <code>init.structure</code> should of course be present in the <code>structure.raster</code>.</p>
<p>Here, we will run a simulation starting with 1 individual, for a maximum of 1.000 infected individuals and a maximum time of 300 days.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">popStructure=</span><span class="st">"continuous"</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                        <span class="dt">length.sim=</span><span class="dv">300</span>, <span class="dt">max.infected=</span><span class="dv">1000</span>, <span class="dt">init.individuals=</span><span class="dv">1</span>, ...)</a></code></pre></div>
</div>
<div id="core-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#core-functions" class="anchor"></a>Core functions</h2>
<p>The core functions <code>pExit</code>, <code>pMove</code>, <code>sdMove</code>, <code>nContact</code> and <code>pTrans</code> each follow the <a href="nosoi.html#setting-up-the-core-functions">same principles to be set up</a>. To accommodate several scenarios, they can be constant, time-dependent (relative time since infection for each individual or “absolute”" time of the simulation), location dependent in the continuous space (value of the environmental variable), or even individually parameterized, to include some stochasticity at the individual-host level. In every case, the function provided, like all other core functions in <code>nosoi</code>, has to be expressed as function of time <code>t</code>, even if time is not used to compute the probability. In case the function uses individual-based parameters, you have to specify a list of functions (called <code>param.pExit</code>, <code>param.pMove</code>, <code>param.sdMove</code>,<code>param.nContact</code> or <code>param.pTrans</code>) ( <a href="nosoi.html#parameters">see Get started</a> ). If no individual-based parameter is used, then they are set to <code>NA</code>.</p>
<blockquote>
<p>Keep in mind that <code>pExit</code>, <code>pMove</code>, and <code>pTrans</code> have to give back a probability (i.e. a number between 0 and 1) while <code>nContact</code> should give back a positive natural number (positive integer) and <code>sdMove</code> a positive number.</p>
</blockquote>
<p>You can combine the influence of several parameters, such as time since infection, “absolute” time of the simulation, location (in the continuous space), and individual-based parameters within the same function.</p>
<blockquote>
<p><code>nosoi</code> can be flexible in what it allows as parameters in your function, but a common general structure should be observed. The argument of the function should be (in that order): (1) time since infection <code>t</code> (obligatory); (2) “absolute” time <code>prestime</code> (optional); (3) current state <code>current.in</code> (optional); (4) host count in state <code>host.count</code> (optional); (5) other individual-based parameter(s), provided in <code>param.function</code>. If one of the argument is not used (except <code>t</code>), then you do not have to provide it and can continue with the next argument.</p>
</blockquote>
<div id="pexit-param-pexit-timedep-pexit-diff-pexit-and-hostcount-pexit" class="section level3">
<h3 class="hasAnchor">
<a href="#pexit-param-pexit-timedep-pexit-diff-pexit-and-hostcount-pexit" class="anchor"></a><code>pExit</code>, <code>param.pExit</code>, <code>timeDep.pExit</code>, <code>diff.pExit</code> and <code>hostCount.pExit</code>
</h3>
<p><code>pExit</code> is the first required fundamental parameter and provides a daily probability for a host to leave the simulation (either cured, died, etc.). <code>param.pExit</code> is the list of function need to individually paramterize <code>pExit</code> ( <a href="nosoi.html#parameters">see Get started</a> ). The name of each function in the list has to have the same name as the parameter it is sampling for <code>pExit</code>. <code>timeDep.pExit</code> allows for <code>pExit</code> to be dependent of the “absolute” time of the simulation, to account, for example, for seasonality or other external time related covariates. By default, <code>timeDep.pExit</code> is set to <code>FALSE</code>. <code>diff.pExit</code> allows <code>pExit</code> to be different according to the current environemental value of the location where the host is located. By default, <code>diff.pExit</code> is set to <code>FALSE</code>. <code>hostCount.pExit</code> allows <code>pExit</code> to differ according to the number of hosts currently in a raster cell. By default, <code>hostCount.pExit</code> is set to <code>FALSE</code>. To use <code>hostCount.pExit</code>, <code>diff.pExit</code> has to be set to <code>TRUE</code> too.</p>
</div>
<div id="pmove-param-pmove-timedep-pmove-diff-pmove-and-hostcount-pmove" class="section level3">
<h3 class="hasAnchor">
<a href="#pmove-param-pmove-timedep-pmove-diff-pmove-and-hostcount-pmove" class="anchor"></a><code>pMove</code>, <code>param.pMove</code>, <code>timeDep.pMove</code>, <code>diff.pMove</code> and <code>hostCount.pMove</code>
</h3>
<p><code>pMove</code> is the probability (per unit of time) for a host to move on the map. It should not be confused with the distance the host will travel linked to <code>sdMove</code> (see below). <code>param.pMove</code> is the list of function need to individually paramterize <code>pMove</code> ( <a href="nosoi.html#parameters">see Get started</a> ). The name of each function in the list has to have the same name as the parameter it is sampling for <code>pMove</code>. <code>timeDep.pMove</code> allows for <code>pMove</code> to be dependent of the “absolute” time of the simulation, to account, for example, for seasonality or other external time related covariates. By default, <code>timeDep.pMove</code> is set to <code>FALSE</code>. <code>diff.pMove</code> allows <code>pMove</code> to be different according to the current environemental value of the location where the host is located. By default, <code>diff.pMove</code> is set to <code>FALSE</code>. <code>hostCount.pMove</code> allows <code>pMove</code> to differ according to the number of hosts currently in a raster cell. By default, <code>hostCount.pMove</code> is set to <code>FALSE</code>. To use <code>hostCount.pMove</code>, <code>diff.pMove</code> has to be set to <code>TRUE</code> too.</p>
</div>
<div id="sdmove-param-sdmove-timedep-sdmove-diff-sdmove-and-hostcount-sdmove" class="section level3">
<h3 class="hasAnchor">
<a href="#sdmove-param-sdmove-timedep-sdmove-diff-sdmove-and-hostcount-sdmove" class="anchor"></a><code>sdMove</code>, <code>param.sdMove</code>, <code>timeDep.sdMove</code>, <code>diff.sdMove</code> and <code>hostCount.sdMove</code>
</h3>
<p><code>sdMove</code> represents the standard deviation of the Brownian motion movement when a host undergo a move (set by <code>pMove</code>). <code>param.sdMove</code> is the list of function need to individually paramterize <code>sdMove</code> ( <a href="nosoi.html#parameters">see Get started</a> ). The name of each function in the list has to have the same name as the parameter it is sampling for <code>sdMove</code>. <code>timeDep.sdMove</code> allows for <code>sdMove</code> to be dependent of the “absolute” time of the simulation, to account, for example, for seasonality or other external time related covariates. By default, <code>timeDep.sdMove</code> is set to <code>FALSE</code>. <code>diff.sdMove</code> allows <code>sdMove</code> to be different according to the current environemental value of the location where the host is located. By default, <code>diff.sdMove</code> is set to <code>FALSE</code>. <code>hostCount.sdMove</code> allows <code>sdMove</code> to differ according to the number of hosts currently in a raster cell. By default, <code>hostCount.sdMove</code> is set to <code>FALSE</code>. To use <code>hostCount.sdMove</code>, <code>diff.sdMove</code> has to be set to <code>TRUE</code> too.</p>
</div>
<div id="ncontact-param-ncontact-timedep-ncontact-diff-ncontact-and-hostcount-ncontact" class="section level3">
<h3 class="hasAnchor">
<a href="#ncontact-param-ncontact-timedep-ncontact-diff-ncontact-and-hostcount-ncontact" class="anchor"></a><code>nContact</code>, <code>param.nContact</code>, <code>timeDep.nContact</code>, <code>diff.nContact</code> and <code>hostCount.nContact</code>
</h3>
<p><code>nContact</code> represents the number (a positive integer) of potentially infectious contacts an infected hosts can encounter per unit of time. At each time point, a number of contacts will be determined for each active host in the simulation. The number of contacts (i.e. the output of your function) has to be an integer and can be set to zero. <code>param.nContact</code> is the list of function need to individually paramterize <code>nContact</code> ( <a href="nosoi.html#parameters">see Get started</a> ). The name of each function in the list has to have the same name as the parameter it is sampling for <code>nContact</code>. <code>timeDep.nContact</code> allows for <code>nContact</code> to be dependent of the “absolute” time of the simulation, to account, for example, for seasonality or other external time related covariates. By default, <code>timeDep.nContact</code> is set to <code>FALSE</code>. <code>diff.nContact</code> allows <code>nContact</code> to be different according to the current environemental value of the location where the host is located. By default, <code>diff.nContact</code> is set to <code>FALSE</code>. <code>hostCount.nContact</code> allows <code>nContact</code> to differ according to the number of hosts currently in a raster cell. This can be useful to adjust the number of contact to the number of potentially susceptible hosts if the infected population is close to the maximum size of the population in a raster cell. By default, <code>hostCount.nContact</code> is set to <code>FALSE</code>. To use <code>hostCount.nContact</code>, <code>diff.nContact</code> has to be set to <code>TRUE</code> too.</p>
</div>
<div id="ptrans-param-ptrans-timedep-ptransdiff-ptrans-and-hostcount-ptrans" class="section level3">
<h3 class="hasAnchor">
<a href="#ptrans-param-ptrans-timedep-ptransdiff-ptrans-and-hostcount-ptrans" class="anchor"></a><code>pTrans</code>, <code>param.pTrans</code>, <code>timeDep.pTrans</code>,<code>diff.pTrans</code> and <code>hostCount.pTrans</code>
</h3>
<p><code>pTrans</code> is the heart of the transmission process and represents the probability of transmission over time (when a contact occurs). <code>param.pTrans</code> is the list of function need to individually paramterize <code>pTrans</code> ( <a href="nosoi.html#parameters">see Get started</a> ). The name of each function in the list has to have the same name as the parameter it is sampling for <code>pTrans</code>. <code>timeDep.pTrans</code> allows for <code>pTrans</code> to be dependent of the “absolute” time of the simulation, to account, for example, for seasonality or other external time related covariates. By default, <code>timeDep.pTrans</code> is set to <code>FALSE</code>. <code>diff.pTrans</code> allows <code>pTrans</code> to be different according to the current environemental value of the location where the host is located. By default, <code>diff.pTrans</code> is set to <code>FALSE</code>. <code>hostCount.pTrans</code> allows <code>pTrans</code> to differ according to the number of hosts currently in a raster cell. By default, <code>hostCount.pTrans</code> is set to <code>FALSE</code>. To use <code>hostCount.pTrans</code>, <code>diff.pTrans</code> has to be set to <code>TRUE</code> too.</p>
</div>
</div>
<div id="miscellaneous" class="section level2">
<h2 class="hasAnchor">
<a href="#miscellaneous" class="anchor"></a>Miscellaneous</h2>
<p><code>prefix.host</code> allows you to define the first character(s) for the host’s unique ID. It will be followed by a hyphen and a unique number. By default, <code>prefix.host</code> is “H” for “Host”.</p>
<p><code>print.progress</code> allows you to get some information printed on the screen about the simulation while running. It will print something every <code>print.step</code>. By default, <code>print.progress</code> is activated, with a <code>print.step = 10</code> (that you can change), but you may want to deactivate it by providing <code>print.progress == FALSE</code>.</p>
</div>
<div id="dual-host" class="section level2">
<h2 class="hasAnchor">
<a href="#dual-host" class="anchor"></a>Dual host</h2>
<p>In the case of a dual host simulation, several parameter of the <code>nosoiSim</code> will have to be specified for each host type, called <code>A</code> and <code>B</code>. The wrapper function <code>nosoiSim</code> will then take all the arguments that will be passed down to the simulator, in the case of this tutorial <code>dualDiscrete</code> (for “dual host, discrete structure”). We thus start by providing the options <code>type="dual"</code> and <code>popStructure="continuous"</code> to set up the analysis:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"dual"</span>, <span class="dt">popStructure=</span><span class="st">"continuous"</span>, ...)</a></code></pre></div>
<p>This function takes several arguments or options to be able to run, namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected.A</code></li>
<li><code>max.infected.B</code></li>
<li><code>init.individuals.A</code></li>
<li><code>init.individuals.B</code></li>
<li><code>init.structure.A</code></li>
<li><code>init.structure.B</code></li>
<li><code>structure.raster.A</code></li>
<li><code>structure.raster.B</code></li>
<li>
<code>pExit.A</code> with <code>param.pExit.A</code>, <code>timeDep.pExit.A</code>, <code>diff.pExit.A</code> and <code>hostCount.pExit.A</code>
</li>
<li>
<code>pMove.A</code> with <code>param.pMove.A</code>, <code>timeDep.pMove.A</code>, <code>diff.pMove.A</code> and <code>hostCount.pMove.A</code>
</li>
<li>
<code>sdMove.A</code> with <code>param.sdMove.A</code>, <code>timeDep.sdMove.A</code>, <code>diff.sdMove.A</code> and <code>hostCount.sdMove.A</code>
</li>
<li><code>attracted.by.raster.A</code></li>
<li>
<code>nContact.A</code> with <code>param.nContact.A</code>, <code>timeDep.nContact.A</code>, <code>diff.nContact.A</code> and <code>hostCount.nContact.A</code>
</li>
<li>
<code>pTrans.A</code> with <code>param.pTrans.A</code>, <code>timeDep.pTrans.A</code>, <code>diff.pTrans.A</code> and <code>hostCount.pTrans.A</code>
</li>
<li><code>prefix.host.A</code></li>
<li>
<code>pExit.B</code> with <code>param.pExit.B</code>, <code>timeDep.pExit.B</code>, <code>diff.pExit.B</code> and <code>hostCount.pExit.B</code>
</li>
<li>
<code>pMove.B</code> with <code>param.pMove.B</code>, <code>timeDep.pMove.B</code>, <code>diff.pMove.B</code> and <code>hostCount.pMove.B</code>
</li>
<li>
<code>sdMove.B</code> with <code>param.sdMove.B</code>, <code>timeDep.sdMove.B</code>, <code>diff.sdMove.B</code> and <code>hostCount.sdMove.B</code>
</li>
<li><code>attracted.by.raster.B</code></li>
<li>
<code>nContact.B</code> with <code>param.nContact.B</code>, <code>timeDep.nContact.B</code>, <code>diff.nContact.B</code> and <code>hostCount.nContact.B</code>
</li>
<li>
<code>pTrans.B</code> with <code>param.pTrans.B</code>, <code>timeDep.pTrans.B</code>, <code>diff.pTrans.B</code> and <code>hostCount.pTrans.B</code>
</li>
<li><code>prefix.host.B</code></li>
<li><code>print.progress</code></li>
<li><code>print.step</code></li>
</ul>
<p>As you can see, host-type dependent parameters are now designated by the suffix <code>.A</code> or <code>.B</code>.</p>
<p>Both <code>max.infected.A</code> and <code>max.infected.B</code> have to be provided to set an upper limit on the simulation size. To initiate the simulation, you have to provide at least on starting host, either <code>A</code> or <code>B</code> in <code>init.individuals.A</code> or <code>init.individuals.B</code> respectively, as well as starting position (vector of coordinates <code><a href="https://www.rdocumentation.org/packages/base/topics/c">c(x,y)</a></code> in the continuous space) in <code>init.individuals.A</code> or <code>init.individuals.B</code>, respectively. If you want to start the simulation with one host only, then <code>init.individuals</code> of the other host can be set to 0 and <code>init.structure</code> to <code>NA</code>.</p>
<p>A major difference here is that hosts may, or not, share the same <code>structure.raster</code>. However, since they exist in the same “world”, they should be in the same coordinate system. It is also possible to have a host that does not move. In such case, <code>pMove</code> can be set to <code>NA</code>, as well as <code>sdMove</code>. In such “non-moving” case, a raster should still be provided, as it anchors the hosts into the simulation’s world.</p>
<p>Here again, all parameters must be provided for both hosts, although <code>timeDep</code>, <code>diff</code> and <code>hostCount</code> have default values set to <code>FALSE</code>; if you do not want to use these options, then you do not have to explicitly provide a value. Be careful to switch <code>diff</code> to <code>TRUE</code> if you want to use <code>hostCount</code>, and remember to provide a result for each state.</p>
</div>
</div>
<div id="running-nosoi" class="section level1">
<h1 class="hasAnchor">
<a href="#running-nosoi" class="anchor"></a>Running <code>nosoi</code>
</h1>
<div id="single-host" class="section level2">
<h2 class="hasAnchor">
<a href="#single-host" class="anchor"></a>Single host</h2>
<p>We will present here a very simple simulation for a single host pathogen.</p>
<div id="pexit" class="section level3">
<h3 class="hasAnchor">
<a href="#pexit" class="anchor"></a>pExit</h3>
<p>For <code>pExit</code>, we will choose a probability that only depends on the environmental value of the location where the host currently is. The maximum value of our environmental raster is close to 70, and the higher the environmental value, the less likely the host will be dying:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t, current.env.value){</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="cf">if</span>(current.env.value <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>){p=<span class="fl">0.02</span>}</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="cf">if</span>(current.env.value <span class="op">&lt;</span><span class="st"> </span><span class="dv">60</span> <span class="op">&amp;&amp;</span><span class="st"> </span>current.env.value <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>){p=<span class="fl">0.04</span>}</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="cf">if</span>(current.env.value <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>){p=<span class="fl">0.08</span>}</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">}</a></code></pre></div>
<p>Taken together, the value for <code>pExit</code> according to the environmental value will be the following:</p>
<p><img src="continuous_files/figure-html/pExit2-1.png" width="700"></p>
<p>Remember that <code>pExit</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>pExit</code> is dependent on the location, <code>diff.pMove=TRUE</code>. However, there is no use of the “absolute” time of the simulation nor individual-based parameters, so <code>param.pExit = NA</code>, and <code>timeDep.pExit=FALSE</code>.</p>
</div>
<div id="pmove" class="section level3">
<h3 class="hasAnchor">
<a href="#pmove" class="anchor"></a>pMove</h3>
<p>We will choose a constant value for <code>pMove</code>, namely 0.1, i.e. an infected host has 10% chance to change its location for each unit of time.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)}</a></code></pre></div>
<p>Remember that <code>pMove</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>pMove</code> is not dependent on the location, <code>diff.pMove=FALSE</code>. Similarly, there is no use of the “absolute” time of the simulation nor individual-based parameters, so <code>param.pMove = NA</code>, and <code>timeDep.pMove=FALSE</code>.</p>
</div>
<div id="sdmove" class="section level3">
<h3 class="hasAnchor">
<a href="#sdmove" class="anchor"></a>sdMove</h3>
<p>We will choose a constant value for <code>sdMove</code>, namely 0.25. <code>sdMove</code> is the standard deviation of the Brownian motion underlying the movement in <code>nosoi</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">sd_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.25</span>)}</a></code></pre></div>
<p>Remember that <code>sdMove</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>sdMove</code> is not dependent on the location, <code>diff.pMove=FALSE</code>. Similarly, there is no use of the “absolute” time of the simulation nor individual-based parameters, so <code>param.sdMove = NA</code>, and <code>timeDep.sdMove=FALSE</code>.</p>
</div>
<div id="ncontact" class="section level3">
<h3 class="hasAnchor">
<a href="#ncontact" class="anchor"></a>nContact</h3>
<p>For <code>nContact</code>, we will choose a constant function that will draw a value in a normal distribution of <em>mean</em> = 0.5 and <em>sd</em> = 1, round it, and take its absolute value.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">0</span>))}</a></code></pre></div>
<p>The distribution of <code>nContact</code> looks like this:</p>
<p><img src="continuous_files/figure-html/nContact2-1.png" width="700"></p>
<p>At each time and for each infected host, <code>nContact</code> will be drawn anew. Remember that <code>nContact</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>nContact</code> is constant here, there is no use of the “absolute” time of the simulation, the location of the host, nor individual-based parameters. So <code>param.nContact = NA</code>, <code>timeDep.nContact=FALSE</code> and <code>diff.nContact=FALSE</code>.</p>
</div>
<div id="ptrans" class="section level3">
<h3 class="hasAnchor">
<a href="#ptrans" class="anchor"></a>pTrans</h3>
<p><code>pTrans</code> will be provided in the form of a threshold function: before a certain amount of time since initial infection, the host does not transmit (incubation time, we will call <code>t_incub</code>), and after that time, it will transmit with a certain (constant) probability (we will call <code>p_max</code>). This function will be dependent of the time since the host’s infection <code>t</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">p_Trans_fct &lt;-<span class="st"> </span><span class="cf">function</span>(t, p_max, t_incub){</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">    <span class="cf">if</span>(t <span class="op">&lt;</span><span class="st"> </span>t_incub){p=<span class="dv">0</span>}</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">    <span class="cf">if</span>(t <span class="op">&gt;=</span><span class="st"> </span>t_incub){p=p_max}</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">}</a></code></pre></div>
<p>Because each host is different (slightly different biotic and abiotic factors), you can expect each host to show differences in the dynamics of infection, and hence probability of transmission over time. Thus, <code>t_incub</code> and <code>p_max</code> will be sampled for each host individually according to a certain distribution. <code>t_incub</code> will be sampled from a normal distribution of <span class="math inline">\(mean\)</span> = 7 and <span class="math inline">\(sd\)</span> = 1, while <code>p_max</code> will be sampled from a beta distribution of parameters <span class="math inline">\(\alpha\)</span> = 5 and <span class="math inline">\(\beta\)</span> = 2.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">7</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">p_max_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(x,<span class="dt">shape1 =</span> <span class="dv">5</span>,<span class="dt">shape2=</span><span class="dv">2</span>)}</a></code></pre></div>
<p>Note that here <code>t_incub</code> and <code>p_max</code> are functions of <code>x</code> and not <code>t</code> (they are not core functions but individual-based parameters), and <code>x</code> enters the function as the number of draws to make.</p>
<p>Taken together, the profile for pTrans for a subset of 200 individuals in the population will look like this:</p>
<p><img src="continuous_files/figure-html/pTrans3-1.png" width="700"></p>
<p>Since <code>pTrans</code> is not dependent of the “absolute” time of the simulation nor is it dependent of the hosts location. So <code>timeDep.pTrans=FALSE</code> and <code>diff.pTrans=FALSE</code>. However, since we have employed individual-based parameters, we have to provide a <code>param.pTrans</code> as a list of functions. The name of each element of the list should have the same name that the core function (pTrans here) uses as argument, as shown here:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">7</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">p_max_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(x,<span class="dt">shape1 =</span> <span class="dv">5</span>,<span class="dt">shape2=</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">param_pTrans =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct)</a></code></pre></div>
</div>
<div id="running" class="section level3">
<h3 class="hasAnchor">
<a href="#running" class="anchor"></a>Running</h3>
<p>Once nosoiSim is set up, you can run the simulation (here the “seed” ensures that you will get the same results as in this tutorial).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nosoi)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#Raster is test.raster</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#Starting position will be</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">start.pos &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># c(x,y)</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#pExit</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t, current.env.value){</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  <span class="cf">if</span>(current.env.value <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>){p=<span class="fl">0.02</span>}</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  <span class="cf">if</span>(current.env.value <span class="op">&lt;</span><span class="st"> </span><span class="dv">60</span> <span class="op">&amp;&amp;</span><span class="st"> </span>current.env.value <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>){p=<span class="fl">0.04</span>}</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">  <span class="cf">if</span>(current.env.value <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>){p=<span class="fl">0.08</span>}</a>
<a class="sourceLine" id="cb12-13" data-line-number="13">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb12-15" data-line-number="15"></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#pMove</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)}</a>
<a class="sourceLine" id="cb12-18" data-line-number="18"></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#sdMove</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20">sd_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.25</span>)}</a>
<a class="sourceLine" id="cb12-21" data-line-number="21"></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#nContact</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">0</span>))}</a>
<a class="sourceLine" id="cb12-24" data-line-number="24"></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#pTrans</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26">proba &lt;-<span class="st"> </span><span class="cf">function</span>(t,p_max,t_incub){</a>
<a class="sourceLine" id="cb12-27" data-line-number="27">  <span class="cf">if</span>(t <span class="op">&lt;=</span><span class="st"> </span>t_incub){p=<span class="dv">0</span>}</a>
<a class="sourceLine" id="cb12-28" data-line-number="28">  <span class="cf">if</span>(t <span class="op">&gt;=</span><span class="st"> </span>t_incub){p=p_max}</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb12-30" data-line-number="30">}</a>
<a class="sourceLine" id="cb12-31" data-line-number="31"></a>
<a class="sourceLine" id="cb12-32" data-line-number="32">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb12-33" data-line-number="33">p_max_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(x,<span class="dt">shape1 =</span> <span class="dv">5</span>,<span class="dt">shape2=</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb12-34" data-line-number="34"></a>
<a class="sourceLine" id="cb12-35" data-line-number="35">param_pTrans =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct)</a>
<a class="sourceLine" id="cb12-36" data-line-number="36"></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="co"># Starting the simulation ------------------------------------</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38"></a>
<a class="sourceLine" id="cb12-39" data-line-number="39"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">846</span>)</a>
<a class="sourceLine" id="cb12-40" data-line-number="40">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">popStructure=</span><span class="st">"continuous"</span>,</a>
<a class="sourceLine" id="cb12-41" data-line-number="41">                        <span class="dt">length.sim=</span><span class="dv">300</span>, <span class="dt">max.infected=</span><span class="dv">300</span>, <span class="dt">init.individuals=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb12-42" data-line-number="42">                        </a>
<a class="sourceLine" id="cb12-43" data-line-number="43">                        <span class="dt">init.structure=</span>start.pos, </a>
<a class="sourceLine" id="cb12-44" data-line-number="44">                        </a>
<a class="sourceLine" id="cb12-45" data-line-number="45">                        <span class="dt">structure.raster=</span>test.raster,</a>
<a class="sourceLine" id="cb12-46" data-line-number="46">                        </a>
<a class="sourceLine" id="cb12-47" data-line-number="47">                        <span class="dt">pExit =</span> p_Exit_fct,</a>
<a class="sourceLine" id="cb12-48" data-line-number="48">                        <span class="dt">param.pExit =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb12-49" data-line-number="49">                        <span class="dt">timeDep.pExit=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-50" data-line-number="50">                        <span class="dt">diff.pExit=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-51" data-line-number="51">                        </a>
<a class="sourceLine" id="cb12-52" data-line-number="52">                        <span class="dt">pMove =</span> p_Move_fct,</a>
<a class="sourceLine" id="cb12-53" data-line-number="53">                        <span class="dt">param.pMove =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb12-54" data-line-number="54">                        <span class="dt">timeDep.pMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-55" data-line-number="55">                        <span class="dt">diff.pMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-56" data-line-number="56">                        </a>
<a class="sourceLine" id="cb12-57" data-line-number="57">                        <span class="dt">sdMove =</span> sd_Move_fct,</a>
<a class="sourceLine" id="cb12-58" data-line-number="58">                        <span class="dt">param.sdMove =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb12-59" data-line-number="59">                        <span class="dt">timeDep.sdMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-60" data-line-number="60">                        <span class="dt">diff.sdMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-61" data-line-number="61">                        </a>
<a class="sourceLine" id="cb12-62" data-line-number="62">                        <span class="dt">attracted.by.raster=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-63" data-line-number="63">                        </a>
<a class="sourceLine" id="cb12-64" data-line-number="64">                        <span class="dt">nContact=</span>n_contact_fct,</a>
<a class="sourceLine" id="cb12-65" data-line-number="65">                        <span class="dt">param.nContact=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb12-66" data-line-number="66">                        <span class="dt">timeDep.nContact=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-67" data-line-number="67">                        <span class="dt">diff.nContact=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-68" data-line-number="68"></a>
<a class="sourceLine" id="cb12-69" data-line-number="69">                        <span class="dt">pTrans =</span> proba,</a>
<a class="sourceLine" id="cb12-70" data-line-number="70">                        <span class="dt">param.pTrans =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct),</a>
<a class="sourceLine" id="cb12-71" data-line-number="71">                        <span class="dt">timeDep.pTrans=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-72" data-line-number="72">                        <span class="dt">diff.pTrans=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-73" data-line-number="73">                      </a>
<a class="sourceLine" id="cb12-74" data-line-number="74">                        <span class="dt">prefix.host=</span><span class="st">"H"</span>,</a>
<a class="sourceLine" id="cb12-75" data-line-number="75">                        <span class="dt">print.progress=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb12-76" data-line-number="76">                        <span class="dt">print.step=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb12-77" data-line-number="77"><span class="co">#&gt; Starting the simulation</span></a>
<a class="sourceLine" id="cb12-78" data-line-number="78"><span class="co">#&gt; Initializing ... running ...</span></a>
<a class="sourceLine" id="cb12-79" data-line-number="79"><span class="co">#&gt; done. </span></a>
<a class="sourceLine" id="cb12-80" data-line-number="80"><span class="co">#&gt; The simulation has run for 40 units of time and a total of 350 hosts have been infected.</span></a></code></pre></div>
<p>Once the simulation is finished, it reports the number of time units for which the simulation has run (40), and the maximum number of infected hosts (350). Note that the simulation has stopped here before reaching <code>length.sim</code> as it has crossed the <code>max.infected</code> threshold set at 300.</p>
</div>
</div>
<div id="dual-host-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dual-host-1" class="anchor"></a>Dual host</h2>
<p>Setting up a dual host simulation is similar to the single host version, but each parameter has to be provided for both hosts. Host A will use the same parameters as the single host above did. Host B will have sightly different parameters:</p>
<div id="pexit-b" class="section level3">
<h3 class="hasAnchor">
<a href="#pexit-b" class="anchor"></a>pExit.B</h3>
<p>For <code>pExit.B</code>, we will choose a value that depends on the “absolute” time of the simulation, for example cyclic climatic conditions (temperature). In that case, the function’s arguments should be <code>t</code> and <code>prestime</code> (the “absolute” time of the simulation), in that order:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">p_Exit_fctB  &lt;-<span class="st"> </span><span class="cf">function</span>(t,prestime){(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(prestime<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">10</span>))<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">16</span>} <span class="co">#for a periodic function</span></a></code></pre></div>
<p>The values of <code>pExit.B</code> across the “absolute time” of the simulation will be the following:</p>
<p><img src="continuous_files/figure-html/pExit2-dual-1.png" width="700"></p>
<p>Since <code>pExit.B</code> is dependent on the simulation’s time, do not forget to set <code>timeDep.pExit.B</code> to <code>TRUE</code>. Since there are no individual-based parameters nor is there any influence of the host’s location, <code>param.pExit.B = NA</code> and <code>diff.pExit.B = NA</code>.</p>
</div>
<div id="pmove-b" class="section level3">
<h3 class="hasAnchor">
<a href="#pmove-b" class="anchor"></a>pMove.B</h3>
<p>We will assume here that hosts B do not move. <code>pMove.B</code> will hence be set to <code>NA</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">p_Move_fct.B  &lt;-<span class="st"> </span><span class="ot">NA</span></a></code></pre></div>
<p>Since <code>pMove.B</code> is not dependent on the location, <code>diff.pMove.B=FALSE</code>. Similarly, there is no use of the “absolute” time of the simulation nor individual-based parameters, so <code>param.pMove.B = NA</code>, and <code>timeDep.pMove.B=FALSE</code>.</p>
</div>
<div id="sdmove-b" class="section level3">
<h3 class="hasAnchor">
<a href="#sdmove-b" class="anchor"></a>sdMove.B</h3>
<p>Since hosts B do not move, <code>sdMove.B</code> is irrelevant and will be set to <code>NA</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">sd_Move_fct.B  &lt;-<span class="st"> </span><span class="ot">NA</span></a></code></pre></div>
<p>Since <code>sdMove.B</code> is not dependent on the location, <code>diff.sdMove.B=FALSE</code>. Similarly, there is no use of the “absolute” time of the simulation nor individual-based parameters, so <code>param.sdMove.B = NA</code>, and <code>timeDep.sdMove.B=FALSE</code>.</p>
</div>
<div id="ncontact-b" class="section level3">
<h3 class="hasAnchor">
<a href="#ncontact-b" class="anchor"></a>nContact.B</h3>
<p>For <code>nContact.B</code>, we will choose a constant function that will sample a value from a provided list of values, with a certain probability:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">n_contact_fct.B =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dt">prob=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>))}</a></code></pre></div>
<p>The distribution of <code>nContact.B</code> looks like this:</p>
<p><img src="continuous_files/figure-html/nContact2.B-1.png" width="700"></p>
<p>At each time and for each infected host, <code>nContact.B</code> will be drawn anew. Remember that <code>nContact.B</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>nContact.B</code> is constant here, there is no use of the “absolute” time of the simulation, the host’s location, nor individual-based parameters. So <code>param.nContact.B = NA</code>, <code>timeDep.nContact.B=FALSE</code> and <code>diff.nContact.B=FALSE</code>.</p>
</div>
<div id="ptrans-b" class="section level3">
<h3 class="hasAnchor">
<a href="#ptrans-b" class="anchor"></a>pTrans.B</h3>
<p><code>pTrans.B</code> will be in the form of a gaussian function: it will its maximum value at a certain time point (mean) after initial infection and then will decrease until it reaches 0. The function <code>dnorm</code> used here will achieve this objective: for each time <code>t</code> after infection, its return value will reach its maximum value (&lt; 1) at its mean (here <code>max.time</code>, a parameter that will be set for each individual, see below) and then decline back to 0. Its increase and decline is parameterised by the standard deviation <code>sd</code> of the <code>dnorm</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">p_Trans_fct.B &lt;-<span class="st"> </span><span class="cf">function</span>(t, max.time){</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(t, <span class="dt">mean=</span>max.time, <span class="dt">sd=</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">}</a></code></pre></div>
<p>Because each host is here also different (slightly different biotic and abiotic factors), you can expect each host to show differences in the dynamics of infection, and hence probability of transmission over time. Thus, <code>max.time</code> will be sampled for each host individually according to a certain distribution. `<code>max.time</code> will be sampled from a normal distribution of parameters <span class="math inline">\(mean\)</span> = 5 and <span class="math inline">\(sd\)</span> = 1.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">max.time_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a></code></pre></div>
<p>Note again that here <code>max.time</code> is a function of <code>x</code> and not <code>t</code> (i.e. not a core function but individual-based parameters), and <code>x</code> enters the function as the number of draws to make.</p>
<p>Taken together, the profile for <code>pTrans</code> for a subset of 200 individuals in the population will look like this:</p>
<p><img src="continuous_files/figure-html/pTrans3.B-1.png" width="700"></p>
<p>Since <code>pTrans.B</code> is not dependent of the “absolute” time of the simulation nor the host’s location, <code>timeDep.pTrans.B=FALSE</code> and <code>diff.pTrans.B=FALSE</code>. However, since we have made use of individual-based parameters, we have to provide a <code>param.pTrans</code> as a list of functions. The names of each element of the list should have the same name that the core function (<code>pTrans.B</code> here) uses as its argument, as shown here:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">max.time_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">param_pTrans.B =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">max.time=</span>max.time_fct)</a></code></pre></div>
</div>
<div id="running-1" class="section level3">
<h3 class="hasAnchor">
<a href="#running-1" class="anchor"></a>Running</h3>
<p>Once nosoiSim is set up, you can run the simulation (here the “seed” ensures that you will get the same results as in this tutorial).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nosoi)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="co">#Raster is test.raster</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"></a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#Starting position will be</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6">start.pos &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># c(x,y)</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#Host A -----------------------------------</span></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="co">#pExit</span></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t, current.env.value){</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">  <span class="cf">if</span>(current.env.value <span class="op">&gt;</span><span class="st"> </span><span class="dv">60</span>){p=<span class="fl">0.02</span>}</a>
<a class="sourceLine" id="cb20-13" data-line-number="13">  <span class="cf">if</span>(current.env.value <span class="op">&lt;</span><span class="st"> </span><span class="dv">60</span> <span class="op">&amp;&amp;</span><span class="st"> </span>current.env.value <span class="op">&gt;</span><span class="st"> </span><span class="dv">30</span>){p=<span class="fl">0.04</span>}</a>
<a class="sourceLine" id="cb20-14" data-line-number="14">  <span class="cf">if</span>(current.env.value <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>){p=<span class="fl">0.08</span>}</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb20-17" data-line-number="17"></a>
<a class="sourceLine" id="cb20-18" data-line-number="18"><span class="co">#pMove</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)}</a>
<a class="sourceLine" id="cb20-20" data-line-number="20"></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#sdMove</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22">sd_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.25</span>)}</a>
<a class="sourceLine" id="cb20-23" data-line-number="23"></a>
<a class="sourceLine" id="cb20-24" data-line-number="24"><span class="co">#nContact</span></a>
<a class="sourceLine" id="cb20-25" data-line-number="25">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">0</span>))}</a>
<a class="sourceLine" id="cb20-26" data-line-number="26"></a>
<a class="sourceLine" id="cb20-27" data-line-number="27"><span class="co">#pTrans</span></a>
<a class="sourceLine" id="cb20-28" data-line-number="28">proba &lt;-<span class="st"> </span><span class="cf">function</span>(t,p_max,t_incub){</a>
<a class="sourceLine" id="cb20-29" data-line-number="29">  <span class="cf">if</span>(t <span class="op">&lt;=</span><span class="st"> </span>t_incub){p=<span class="dv">0</span>}</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">  <span class="cf">if</span>(t <span class="op">&gt;=</span><span class="st"> </span>t_incub){p=p_max}</a>
<a class="sourceLine" id="cb20-31" data-line-number="31">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb20-32" data-line-number="32">}</a>
<a class="sourceLine" id="cb20-33" data-line-number="33"></a>
<a class="sourceLine" id="cb20-34" data-line-number="34">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb20-35" data-line-number="35">p_max_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(x,<span class="dt">shape1 =</span> <span class="dv">5</span>,<span class="dt">shape2=</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb20-36" data-line-number="36"></a>
<a class="sourceLine" id="cb20-37" data-line-number="37">param_pTrans =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct)</a>
<a class="sourceLine" id="cb20-38" data-line-number="38"></a>
<a class="sourceLine" id="cb20-39" data-line-number="39"><span class="co">#Host B -----------------------------------</span></a>
<a class="sourceLine" id="cb20-40" data-line-number="40"></a>
<a class="sourceLine" id="cb20-41" data-line-number="41"><span class="co">#pExit</span></a>
<a class="sourceLine" id="cb20-42" data-line-number="42">p_Exit_fct.B  &lt;-<span class="st"> </span><span class="cf">function</span>(t,prestime){(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(prestime<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="dv">10</span>))<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">16</span>}</a>
<a class="sourceLine" id="cb20-43" data-line-number="43"></a>
<a class="sourceLine" id="cb20-44" data-line-number="44"><span class="co">#pMove</span></a>
<a class="sourceLine" id="cb20-45" data-line-number="45">p_Move_fct.B  &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb20-46" data-line-number="46"></a>
<a class="sourceLine" id="cb20-47" data-line-number="47"><span class="co">#pMove</span></a>
<a class="sourceLine" id="cb20-48" data-line-number="48">sd_Move_fct.B  &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb20-49" data-line-number="49"></a>
<a class="sourceLine" id="cb20-50" data-line-number="50"><span class="co">#nContact</span></a>
<a class="sourceLine" id="cb20-51" data-line-number="51">n_contact_fct.B =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dt">prob=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>))}</a>
<a class="sourceLine" id="cb20-52" data-line-number="52"></a>
<a class="sourceLine" id="cb20-53" data-line-number="53"><span class="co">#pTrans</span></a>
<a class="sourceLine" id="cb20-54" data-line-number="54">p_Trans_fct.B &lt;-<span class="st"> </span><span class="cf">function</span>(t, max.time){</a>
<a class="sourceLine" id="cb20-55" data-line-number="55">  <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(t, <span class="dt">mean=</span>max.time, <span class="dt">sd=</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">5</span></a>
<a class="sourceLine" id="cb20-56" data-line-number="56">}</a>
<a class="sourceLine" id="cb20-57" data-line-number="57"> </a>
<a class="sourceLine" id="cb20-58" data-line-number="58">max.time_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb20-59" data-line-number="59"></a>
<a class="sourceLine" id="cb20-60" data-line-number="60">param_pTrans.B =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">max.time=</span>max.time_fct)</a>
<a class="sourceLine" id="cb20-61" data-line-number="61"></a>
<a class="sourceLine" id="cb20-62" data-line-number="62"><span class="co"># Starting the simulation ------------------------------------</span></a>
<a class="sourceLine" id="cb20-63" data-line-number="63"></a>
<a class="sourceLine" id="cb20-64" data-line-number="64"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">60</span>)</a>
<a class="sourceLine" id="cb20-65" data-line-number="65">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"dual"</span>, <span class="dt">popStructure=</span><span class="st">"continuous"</span>,</a>
<a class="sourceLine" id="cb20-66" data-line-number="66">                        <span class="dt">length.sim=</span><span class="dv">300</span>, </a>
<a class="sourceLine" id="cb20-67" data-line-number="67">                        <span class="dt">max.infected.A=</span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb20-68" data-line-number="68">                        <span class="dt">max.infected.B=</span><span class="dv">200</span>,</a>
<a class="sourceLine" id="cb20-69" data-line-number="69">                        <span class="dt">init.individuals.A=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb20-70" data-line-number="70">                        <span class="dt">init.individuals.B=</span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb20-71" data-line-number="71">                        <span class="dt">init.structure.A=</span>start.pos,</a>
<a class="sourceLine" id="cb20-72" data-line-number="72">                        <span class="dt">init.structure.B=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-73" data-line-number="73">                        <span class="dt">structure.raster.A=</span>test.raster,</a>
<a class="sourceLine" id="cb20-74" data-line-number="74">                        <span class="dt">structure.raster.B=</span>test.raster,</a>
<a class="sourceLine" id="cb20-75" data-line-number="75"></a>
<a class="sourceLine" id="cb20-76" data-line-number="76">                        <span class="dt">pExit.A =</span> p_Exit_fct,</a>
<a class="sourceLine" id="cb20-77" data-line-number="77">                        <span class="dt">param.pExit.A =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-78" data-line-number="78">                        <span class="dt">timeDep.pExit.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-79" data-line-number="79">                        <span class="dt">diff.pExit.A=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-80" data-line-number="80">                        </a>
<a class="sourceLine" id="cb20-81" data-line-number="81">                        <span class="dt">pMove.A =</span> p_Move_fct,</a>
<a class="sourceLine" id="cb20-82" data-line-number="82">                        <span class="dt">param.pMove.A =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-83" data-line-number="83">                        <span class="dt">timeDep.pMove.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-84" data-line-number="84">                        <span class="dt">diff.pMove.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-85" data-line-number="85">                        </a>
<a class="sourceLine" id="cb20-86" data-line-number="86">                        <span class="dt">sdMove.A =</span> sd_Move_fct,</a>
<a class="sourceLine" id="cb20-87" data-line-number="87">                        <span class="dt">param.sdMove.A =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-88" data-line-number="88">                        <span class="dt">timeDep.sdMove.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-89" data-line-number="89">                        <span class="dt">diff.sdMove.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-90" data-line-number="90">                        <span class="dt">attracted.by.raster.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-91" data-line-number="91">                        </a>
<a class="sourceLine" id="cb20-92" data-line-number="92">                        <span class="dt">nContact.A=</span>n_contact_fct,</a>
<a class="sourceLine" id="cb20-93" data-line-number="93">                        <span class="dt">param.nContact.A=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-94" data-line-number="94">                        <span class="dt">timeDep.nContact.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-95" data-line-number="95">                        <span class="dt">diff.nContact.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-96" data-line-number="96"></a>
<a class="sourceLine" id="cb20-97" data-line-number="97">                        <span class="dt">pTrans.A =</span> proba,</a>
<a class="sourceLine" id="cb20-98" data-line-number="98">                        <span class="dt">param.pTrans.A =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct),</a>
<a class="sourceLine" id="cb20-99" data-line-number="99">                        <span class="dt">timeDep.pTrans.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-100" data-line-number="100">                        <span class="dt">diff.pTrans.A=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-101" data-line-number="101">                        <span class="dt">prefix.host.A=</span><span class="st">"H"</span>,</a>
<a class="sourceLine" id="cb20-102" data-line-number="102">                        </a>
<a class="sourceLine" id="cb20-103" data-line-number="103">                        <span class="dt">pExit.B =</span> p_Exit_fct.B,</a>
<a class="sourceLine" id="cb20-104" data-line-number="104">                        <span class="dt">param.pExit.B =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-105" data-line-number="105">                        <span class="dt">timeDep.pExit.B=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-106" data-line-number="106">                        <span class="dt">diff.pExit.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-107" data-line-number="107">                        </a>
<a class="sourceLine" id="cb20-108" data-line-number="108">                        <span class="dt">pMove.B =</span> p_Move_fct.B,</a>
<a class="sourceLine" id="cb20-109" data-line-number="109">                        <span class="dt">param.pMove.B =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-110" data-line-number="110">                        <span class="dt">timeDep.pMove.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-111" data-line-number="111">                        <span class="dt">diff.pMove.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-112" data-line-number="112">                        </a>
<a class="sourceLine" id="cb20-113" data-line-number="113">                        <span class="dt">sdMove.B =</span> sd_Move_fct.B,</a>
<a class="sourceLine" id="cb20-114" data-line-number="114">                        <span class="dt">param.sdMove.B =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-115" data-line-number="115">                        <span class="dt">timeDep.sdMove.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-116" data-line-number="116">                        <span class="dt">diff.sdMove.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-117" data-line-number="117">                        <span class="dt">attracted.by.raster.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-118" data-line-number="118">                        </a>
<a class="sourceLine" id="cb20-119" data-line-number="119">                        <span class="dt">nContact.B=</span>n_contact_fct.B,</a>
<a class="sourceLine" id="cb20-120" data-line-number="120">                        <span class="dt">param.nContact.B=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb20-121" data-line-number="121">                        <span class="dt">timeDep.nContact.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-122" data-line-number="122">                        <span class="dt">diff.nContact.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-123" data-line-number="123"></a>
<a class="sourceLine" id="cb20-124" data-line-number="124">                        <span class="dt">pTrans.B =</span> p_Trans_fct.B,</a>
<a class="sourceLine" id="cb20-125" data-line-number="125">                        <span class="dt">param.pTrans.B =</span> param_pTrans.B,</a>
<a class="sourceLine" id="cb20-126" data-line-number="126">                        <span class="dt">timeDep.pTrans.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-127" data-line-number="127">                        <span class="dt">diff.pTrans.B=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb20-128" data-line-number="128">                        <span class="dt">prefix.host.B=</span><span class="st">"V"</span>,</a>
<a class="sourceLine" id="cb20-129" data-line-number="129">                        </a>
<a class="sourceLine" id="cb20-130" data-line-number="130">                        <span class="dt">print.progress=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb20-131" data-line-number="131"><span class="co">#&gt; Starting the simulation</span></a>
<a class="sourceLine" id="cb20-132" data-line-number="132"><span class="co">#&gt; Initializing ... running ...</span></a>
<a class="sourceLine" id="cb20-133" data-line-number="133"><span class="co">#&gt; done. </span></a>
<a class="sourceLine" id="cb20-134" data-line-number="134"><span class="co">#&gt; The simulation has run for 33 units of time and a total of 102 (A) and 137 (B) hosts have been infected.</span></a></code></pre></div>
<p>Once the simulation is finished, it reports the number of time units for which the simulation has run (33), and the maximum number of infected hosts A (102) and hosts B (137). Note that the simulation has stopped here before reaching <code>length.sim</code> as it has crossed the <code>max.infected.A</code> threshold set at 100.</p>
</div>
</div>
</div>
<div id="going-further" class="section level1">
<h1 class="hasAnchor">
<a href="#going-further" class="anchor"></a>Going further</h1>
<p>To analyse and visualise your <code>nosoi</code> simulation output, you can have a look on <a href="example/viz.html">this page</a>.</p>
<p>A practical example using a dual host type of simulation with population structure in a continuous space is also available:</p>
<ul>
<li>
<a href="example/ebola.html">Spread of Ebola virus in a continuous space</a>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#structure-of-the-population">Structure of the population</a><ul class="nav nav-pills nav-stacked">
<li><a href="#continuous-space">Continuous space</a></li>
      <li><a href="#movement-kernel">Movement kernel</a></li>
      </ul>
</li>
      <li>
<a href="#setting-up-the-simulation">Setting up the simulation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#general-parameters">General parameters</a></li>
      <li><a href="#core-functions">Core functions</a></li>
      <li><a href="#miscellaneous">Miscellaneous</a></li>
      <li><a href="#dual-host">Dual host</a></li>
      </ul>
</li>
      <li>
<a href="#running-nosoi">Running <code>nosoi</code></a><ul class="nav nav-pills nav-stacked">
<li><a href="#single-host">Single host</a></li>
      <li><a href="#dual-host-1">Dual host</a></li>
      </ul>
</li>
      <li><a href="#going-further">Going further</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Lequime, Paul Bastide, Simon Dellicour, Philippe Lemey, Guy Baele.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
