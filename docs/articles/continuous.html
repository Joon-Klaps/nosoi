<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spread of a pathogen in a continuous space • nosoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spread of a pathogen in a continuous space">
<meta property="og:description" content="nosoi">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nosoi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nosoi.html">
    <span class="fas fa-play-circle"></span>
     
    Getting started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Simulation set up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Visualise &amp; summarise
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/output.html">nosoi output</a>
    </li>
    <li>
      <a href="../articles/examples/viz.html">Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Pathogen examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/examples/ebola.html">Spread of Ebola-like virus in a continuous space</a>
    </li>
    <li>
      <a href="../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/slequime/nosoi" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spread of a pathogen in a continuous space</h1>
                        <h4 data-toc-skip class="author">Sebastian
Lequime</h4>
            
            <h4 data-toc-skip class="date">2024-02-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slequime/nosoi/blob/HEAD/vignettes/continuous.Rmd" class="external-link"><code>vignettes/continuous.Rmd</code></a></small>
      <div class="hidden name"><code>continuous.Rmd</code></div>

    </div>

    
    
<p>Aside from the simple simulation set up, explored in <a href="none.html">another tutorial</a>, where hosts are “not structured”,
<code>nosoi</code> can take into account a population structured either
in discrete states or in a continuous space. We focus here on a
continuous space structure (for the discrete structure, see <a href="discrete.html">this tutorial</a>).</p>
<p>The continuous space is intended to allow the simulation to take
place in a geographical context where hosts can move on a map, and may
be influenced by heterogeneously distributed variables (environmental
for example) on said map.</p>
<p>This tutorial focuses on setting up a <code>nosoi</code> simulation
for a pathogen which spread occurs in a continuous space.</p>
<div class="section level2">
<h2 id="structure-of-the-population">Structure of the population<a class="anchor" aria-label="anchor" href="#structure-of-the-population"></a>
</h2>
<div class="section level3">
<h3 id="continuous-space">Continuous space<a class="anchor" aria-label="anchor" href="#continuous-space"></a>
</h3>
<p>In the continuous space, the simulation takes place on a map defined
by its coordinates. This map is actually a raster, here denoted by
<code>structure.raster</code>, that also holds an environmental value of
interest that may influence the epidemic process. Areas were hosts
cannot move (water, inaccessible areas, etc) must be defined by the
value <code>NA</code>.</p>
<p>Here, we generate a random raster for the purpose of this tutorial,
but you can use a “real” world raster and simulate your epidemic on it
(see <a href="https://slequime.github.io/nosoi/articles/examples/ebola.html" class="external-link">this
example</a>).</p>
<details><summary>
Code used to create the random raster used in this tutorial
</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">860</span><span class="op">)</span></span>
<span><span class="va">test.raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span>nrows<span class="op">=</span><span class="fl">100</span>, ncols<span class="op">=</span><span class="fl">100</span>, xmn<span class="op">=</span><span class="op">-</span><span class="fl">50</span>, xmx<span class="op">=</span><span class="fl">50</span>, ymn<span class="op">=</span><span class="op">-</span><span class="fl">50</span>,ymx<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">test.raster</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="op">-</span><span class="fl">80</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">test.raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/focal.html" class="external-link">focal</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/focal.html" class="external-link">focal</a></span><span class="op">(</span><span class="va">test.raster</span>, w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span>, w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="continuous_files/figure-html/RasterCode2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="movement-kernel">Movement kernel<a class="anchor" aria-label="anchor" href="#movement-kernel"></a>
</h3>
<p>Movements in <code>nosoi</code> are basically described by a random
walk (Brownian motion), that can be attracted by the underlying
environmental variable (<code>attracted.by.raster</code>). In any case,
the movement cannot land into areas out of the raster nor into areas of
the raster with no value (<code>NA</code>).</p>
<p>The user provides a core function <code>sdMove</code> that gives the
standard deviation of this Brownian motion. This function, <a href="nosoi.html#setting-up-the-core-functions">like the other core
functions</a>, can be dependent on the time since infection
<code>t</code>, the absolute time of the simulation
<code>prestime</code>, the location (value of the environmental
variable) or individual-based parameters. This standard deviation is in
your coordinate space, so the actual distance traveled by the host may
actually vary according to your space.</p>
<p>In the case where hosts are attracted by the raster, hosts will tend
to go to positions with high environmental values. Internally, once a
new position is proposed, its environmental value is extracted and
normalized (against the highest environmental value). This normalized
number represents its probability of acceptance. Up to 30 draws can be
made until one is accepted (by default the 30<span class="math inline">\(^{th}\)</span> move is always accepted; this value
was empirically set to allow enough exploration without being stuck in a
time consuming search).</p>
<p>The figure below shows a movement on a simple gradient raster, with
or without an attraction (<code>sdMove</code> is a constant fixed at
0.01, time is 1000 units of time, maximum value of the environmental
variable is 300). The red point represents the starting position.</p>
<p><img src="continuous_files/figure-html/RW-1-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-the-simulation">Setting up the simulation<a class="anchor" aria-label="anchor" href="#setting-up-the-simulation"></a>
</h2>
<p>The wrapper function <code>nosoiSim</code> takes all the arguments
that will be passed down to the simulator, in the case of this tutorial
<code>singleContinuous</code> (for “single host, continuous space”). We
thus start by providing the options <code>type="single"</code> and
<code>popStructure="continuous"</code> to set up the analysis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SimulationSingle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"single"</span>, popStructure<span class="op">=</span><span class="st">"continuous"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>This simulation type requires several arguments or options in order
to run, namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected</code></li>
<li><code>init.individuals</code></li>
<li><code>init.structure</code></li>
<li><code>structure.raster</code></li>
<li>
<code>pExit</code> with <code>param.pExit</code>,
<code>timeDep.pExit</code>, <code>diff.pExit</code> and
<code>hostCount.pExit</code>
</li>
<li>
<code>pMove</code> with <code>param.pMove</code>,
<code>timeDep.pMove</code>, <code>diff.pMove</code> and
<code>hostCount.pMove</code>
</li>
<li>
<code>sdMove</code> with <code>param.sdMove</code>,
<code>timeDep.sdMove</code>, <code>diff.sdMove</code> and
<code>hostCount.sdMove</code>
</li>
<li><code>attracted.by.raster</code></li>
<li>
<code>nContact</code> with <code>param.nContact</code>,
<code>timeDep.nContact</code>, <code>diff.nContact</code> and
<code>hostCount.nContact</code>
</li>
<li>
<code>pTrans</code> with <code>param.pTrans</code>,
<code>timeDep.pTrans</code>, <code>diff.pTrans</code> and
<code>hostCount.pTrans</code>
</li>
<li><code>prefix.host.A</code></li>
<li><code>print.progress</code></li>
<li><code>print.step</code></li>
</ul>
<p>All the <code>param.*</code> elements provide individual-level
parameters to be taken into account, while the <code>timeDep.*</code>
elements inform the simulator if the “absolute” simulation time should
be taken into account. The <code>diff.*</code> elements inform the
simulator if there is a differential probability according to the state
the host is currently in and the <code>hostCount.*</code> elements
inform the simulator if the number of host in each state has to be taken
into account. All parameters must be provided, although
<code>timeDep.*</code>, <code>diff.*</code> and <code>hostCount.*</code>
have default values set to <code>FALSE</code>; if you do not want to use
these options, then you do not have to explicitly provide a value.</p>
<div class="section level3">
<h3 id="general-parameters">General parameters<a class="anchor" aria-label="anchor" href="#general-parameters"></a>
</h3>
<p><code>length.sim</code> and <code>max.infected</code> are general
parameters that define the simulation:</p>
<ul>
<li>
<code>length.sim</code> is the maximum number of time units
(e.g. days, months, years, or another time unit of choice) during which
the simulation will be run.</li>
<li>
<code>max.infected</code> is the maximum number of individuals that
can be infected during the simulation.</li>
</ul>
<p><code>init.individuals</code> and <code>init.structure</code> are the
“seeding parameters”:</p>
<ul>
<li>
<code>init.individuals</code> defines the number of individuals (an
integer above 1) that will start a transmission chain. Keep in mind that
you will have as many transmission chains as initial individuals, which
is equivalent as launching a number of independent nosoi
simulations.</li>
<li>
<code>init.structure</code> specifies the original location (as a
vector of two coordinates, x and y) in the continuous space (has to be
the same starting location for all starting individuals). The location
provided in <code>init.structure</code> should of course be present in
the <code>structure.raster</code>.</li>
</ul>
<p>Here, we will run a simulation starting with 1 individual, for a
maximum of 1,000 infected individuals and a maximum time of 300
days.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SimulationSingle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"single"</span>, popStructure<span class="op">=</span><span class="st">"continuous"</span>,</span>
<span>                             length.sim<span class="op">=</span><span class="fl">300</span>, max.infected<span class="op">=</span><span class="fl">1000</span>, init.individuals<span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="core-functions">Core functions<a class="anchor" aria-label="anchor" href="#core-functions"></a>
</h3>
<p>The core functions <code>pExit</code>, <code>nContact</code>,
<code>pMove</code>, <code>sdMove</code> and <code>pTrans</code> each
follow the <a href="nosoi.html#setting-up-the-core-functions">same
principles to be set up</a>.</p>
<p>To accommodate for different scenarios, they can be constant,
time-dependent (using the relative time since infection <code>t</code>
for each individual or the “absolute” time <code>pres.time</code> of the
simulation) or even individually parameterized, to include some
stochasticity at the individual-host level.</p>
<p>In any case, the provided function, like all other core functions in
<code>nosoi</code>, has to be expressed as a function of time
<code>t</code>, even if time is not used to compute the probability.</p>
<p>In case the function uses individual-based parameters, they must be
specified in a list of functions (called <code>param.pExit</code>,
<code>param.nContact</code>, <code>param.pMove</code>,
<code>param.sdMove</code> or <code>param.pTrans</code>) (see <a href="nosoi.html#parameters">Get started</a>). If no individual-based
parameters are used, then these lists are set to <code>NA</code>.</p>
<blockquote>
<p>Keep in mind that <code>pExit</code>, <code>pMove</code>, and
<code>pTrans</code> have to return a probability (i.e. a value between 0
and 1) while <code>nContact</code> should return a natural number
(positive integer or zero) and <code>sdMove</code> a positive
number.</p>
</blockquote>
<p>Several parameters, such as the time since infection, the “absolute”
time of the simulation, the location (in the discrete states) and
individual-based parameters can be combined within the same
function.</p>
<blockquote>
<p><code>nosoi</code> can be flexible in what it allows as parameters in
your function, but a common general structure should be observed. The
argument of the function should be (in that order):</p>
<ol style="list-style-type: decimal">
<li>time since infection <code>t</code> (compulsory);</li>
<li>“absolute” time <code>prestime</code> (optional);</li>
<li>current environmental value <code>current.env.value</code>
(optional);</li>
<li>host count in state <code>host.count</code> (optional);</li>
<li>other individual-based parameter(s), provided in
<code>param.function</code>.</li>
</ol>
<p>If one of the argument is not used (except <code>t</code>), then you
do not have to provide it and can continue with the next argument.</p>
</blockquote>
<div class="section level4">
<h4 id="pexit-param-pexit-timedep-pexit-diff-pexit-and-hostcount-pexit">
<code>pExit</code>, <code>param.pExit</code>,
<code>timeDep.pExit</code>, <code>diff.pExit</code> and
<code>hostCount.pExit</code><a class="anchor" aria-label="anchor" href="#pexit-param-pexit-timedep-pexit-diff-pexit-and-hostcount-pexit"></a>
</h4>
<ul>
<li>
<code>pExit</code> is the first required fundamental parameter and
provides a daily probability for a host to leave the simulation (either
cured, died, etc.).</li>
<li>
<code>param.pExit</code> is the list of functions needed to
individually parameterize <code>pExit</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function
in the list has to match the name of the parameter it is sampling for
<code>pExit</code>.</li>
<li>
<code>timeDep.pExit</code> allows for <code>pExit</code> to be
dependent on the “absolute” time of the simulation, to account - for
example - for seasonality or other external time-related covariates. By
default, <code>timeDep.pExit</code> is set to <code>FALSE</code>.</li>
<li>
<code>diff.pExit</code> allows <code>pExit</code> to differ
according to the current discrete state of the host. This can be useful,
for example, if one state has a higher mortality rate (or better cures!)
for the infection, in that case the probability to exit the simulation
is higher. By default, <code>diff.pExit</code> is set to
<code>FALSE</code>. Be careful, every state should give back a result
for <code>pExit</code>.</li>
<li>
<code>hostCount.pExit</code> allows <code>pExit</code> to differ
according to the number of hosts currently in a state. By default,
<code>hostCount.pExit</code> is set to <code>FALSE</code>. To use
<code>hostCount.pExit</code>, <code>diff.pExit</code> has to be set to
<code>TRUE</code> too.</li>
</ul>
</div>
<div class="section level4">
<h4 id="pmove-param-pmove-timedep-pmove-diff-pmove-and-hostcount-pmove">
<code>pMove</code>, <code>param.pMove</code>,
<code>timeDep.pMove</code>, <code>diff.pMove</code> and
<code>hostCount.pMove</code><a class="anchor" aria-label="anchor" href="#pmove-param-pmove-timedep-pmove-diff-pmove-and-hostcount-pmove"></a>
</h4>
<ul>
<li>
<code>pMove</code> is the probability (per unit of time) for a host
to move on the map. It should not be confused with the distance the host
will travel linked to <code>sdMove</code> (see below).</li>
<li>
<code>param.pMove</code> is the list of functions needed to
individually parameterize <code>pMove</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function
in the list has to match the name of the parameter it is sampling for
<code>pMove</code>.</li>
<li>
<code>timeDep.pMove</code> allows for <code>pMove</code> to be
dependent of the “absolute” time of the simulation, to account, for
example, for seasonality or other external time related covariates. By
default, <code>timeDep.pMove</code> is set to <code>FALSE</code>.</li>
<li>
<code>diff.pMove</code> allows <code>pMove</code> to be different
according to the current environmental value of the location where the
host is located. By default, <code>diff.pMove</code> is set to
<code>FALSE</code>.</li>
<li>
<code>hostCount.pMove</code> allows <code>pMove</code> to differ
according to the number of hosts currently in a raster cell. By default,
<code>hostCount.pMove</code> is set to <code>FALSE</code>. To use
<code>hostCount.pMove</code>, <code>diff.pMove</code> has to be set to
<code>TRUE</code> too.</li>
</ul>
</div>
<div class="section level4">
<h4 id="sdmove-param-sdmove-timedep-sdmove-diff-sdmove-and-hostcount-sdmove">
<code>sdMove</code>, <code>param.sdMove</code>,
<code>timeDep.sdMove</code>, <code>diff.sdMove</code> and
<code>hostCount.sdMove</code><a class="anchor" aria-label="anchor" href="#sdmove-param-sdmove-timedep-sdmove-diff-sdmove-and-hostcount-sdmove"></a>
</h4>
<ul>
<li>
<code>sdMove</code> represents the standard deviation of the
Brownian motion movement when a host undergo a move (set by
<code>pMove</code>).</li>
<li>
<code>param.sdMove</code> is the list of function need to
individually parameterize <code>sdMove</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function
in the list has to have the same name as the parameter it is sampling
for <code>sdMove</code>.</li>
<li>
<code>timeDep.sdMove</code> allows for <code>sdMove</code> to be
dependent of the “absolute” time of the simulation, to account, for
example, for seasonality or other external time related covariates. By
default, <code>timeDep.sdMove</code> is set to <code>FALSE</code>.</li>
<li>
<code>diff.sdMove</code> allows <code>sdMove</code> to be different
according to the current environmental value of the location where the
host is located. By default, <code>diff.sdMove</code> is set to
<code>FALSE</code>.</li>
<li>
<code>hostCount.sdMove</code> allows <code>sdMove</code> to differ
according to the number of hosts currently in a raster cell. By default,
<code>hostCount.sdMove</code> is set to <code>FALSE</code>. To use
<code>hostCount.sdMove</code>, <code>diff.sdMove</code> has to be set to
<code>TRUE</code> too.</li>
</ul>
</div>
<div class="section level4">
<h4 id="ncontact-param-ncontact-timedep-ncontact-diff-ncontact-and-hostcount-ncontact">
<code>nContact</code>, <code>param.nContact</code>,
<code>timeDep.nContact</code>, <code>diff.nContact</code> and
<code>hostCount.nContact</code><a class="anchor" aria-label="anchor" href="#ncontact-param-ncontact-timedep-ncontact-diff-ncontact-and-hostcount-ncontact"></a>
</h4>
<ul>
<li>
<code>nContact</code> represents the number (expressed as a positive
integer) of potentially infectious contacts an infected hosts can
encounter per unit of time. At each time point, a number of contacts
will be determined for each active host in the simulation. The number of
contacts (i.e. the output of your function) has to be an integer and can
be set to zero.</li>
<li>
<code>param.nContact</code> is the list of functions needed to
individually parameterize <code>nContact</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function
in the list has to match the name of the parameter it is sampling for
<code>nContact</code>.</li>
<li>
<code>timeDep.nContact</code> allows for <code>nContact</code> to be
dependent on the “absolute” time of the simulation, to account - for
example - for seasonality or other external time-related covariates. By
default, <code>timeDep.nContact</code> is set to
<code>FALSE</code>.</li>
<li>
<code>diff.nContact</code> allows for <code>nContact</code> to
differ according to the current discrete state of the host. By default,
<code>diff.nContact</code> is set to <code>FALSE</code>.</li>
<li>
<code>hostCount.nContact</code> allows <code>nContact</code> to
differ according to the number of hosts currently in a raster cell. This
can be useful to adjust the number of contact to the number of
potentially susceptible hosts if the infected population is close to the
maximum size of the population in a raster cell. By default,
<code>hostCount.nContact</code> is set to <code>FALSE</code>. To use
<code>hostCount.nContact</code>, <code>diff.nContact</code> has to be
set to <code>TRUE</code> too.</li>
</ul>
</div>
<div class="section level4">
<h4 id="ptrans-param-ptrans-timedep-ptransdiff-ptrans-and-hostcount-ptrans">
<code>pTrans</code>, <code>param.pTrans</code>,
<code>timeDep.pTrans</code>,<code>diff.pTrans</code> and
<code>hostCount.pTrans</code><a class="anchor" aria-label="anchor" href="#ptrans-param-ptrans-timedep-ptransdiff-ptrans-and-hostcount-ptrans"></a>
</h4>
<ul>
<li>
<code>pTrans</code> is the heart of the transmission process and
represents the probability of transmission over time (when a contact
occurs).</li>
<li>
<code>param.pTrans</code> is the list of functions needed to
individually parameterize <code>pTrans</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function
in the list has to match the name of the parameter it is sampling for
<code>pTrans</code>.</li>
<li>
<code>timeDep.pTrans</code> allows for <code>pTrans</code> to be
dependent on the “absolute” time of the simulation, to account - for
example - for seasonality or other external time-related covariates. By
default, <code>timeDep.pTrans</code> is set to <code>FALSE</code>.</li>
<li>
<code>diff.pTrans</code> allows for <code>pTrans</code> to be
different according to the current discrete state of the host. This can
be used to account of different dynamics linked to external factors
common within a state, such as temperature for example. By default,
<code>diff.pTrans</code> is set to <code>FALSE</code>.</li>
<li>
<code>hostCount.pTrans</code> allows <code>pTrans</code> to differ
according to the number of hosts currently in a raster cell. By default,
<code>hostCount.pTrans</code> is set to <code>FALSE</code>. To use
<code>hostCount.pTrans</code>, <code>diff.pTrans</code> has to be set to
<code>TRUE</code> too.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="miscellaneous">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous"></a>
</h3>
<p><code>prefix.host</code> allows you to define the first character(s)
for the hosts’ unique ID. It will be followed by a hyphen and a unique
number. By default, <code>prefix.host</code> is “H” for “Host”.</p>
<p><code>print.progress</code> allows you to have some information
printed on the screen about the simulation as it is running. It will
print something every <code>print.step</code>. By default,
<code>print.progress</code> is activated with a
<code>print.step = 10</code> (you can change this frequency), but you
may want to deactivate it by setting
<code>print.progress=FALSE</code>.</p>
</div>
<div class="section level3">
<h3 id="dual-host">Dual host<a class="anchor" aria-label="anchor" href="#dual-host"></a>
</h3>
<p>In the case of a dual host simulation, several parameters of the
<code>nosoiSim</code> will have to be specified for each host type,
designated by <code>A</code> and <code>B</code>. The wrapper function
<code>nosoiSim</code> will then take all the arguments that will be
passed down to the simulator, in the case of this tutorial
<code>dualContinuous</code> (for “dual host, continuous structure”). We
thus start by providing the options <code>type="dual"</code> and
<code>popStructure="continuous"</code> to set up the analysis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SimulationDual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"dual"</span>, popStructure<span class="op">=</span><span class="st">"continuous"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<p>This function takes several arguments or options to be able to run,
namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected.A</code></li>
<li><code>max.infected.B</code></li>
<li><code>init.individuals.A</code></li>
<li><code>init.individuals.B</code></li>
<li><code>init.structure.A</code></li>
<li><code>init.structure.B</code></li>
<li><code>structure.raster.A</code></li>
<li><code>structure.raster.B</code></li>
<li>
<code>pExit.A</code> with <code>param.pExit.A</code>,
<code>timeDep.pExit.A</code>, <code>diff.pExit.A</code> and
<code>hostCount.pExit.A</code>
</li>
<li>
<code>pMove.A</code> with <code>param.pMove.A</code>,
<code>timeDep.pMove.A</code>, <code>diff.pMove.A</code> and
<code>hostCount.pMove.A</code>
</li>
<li>
<code>sdMove.A</code> with <code>param.sdMove.A</code>,
<code>timeDep.sdMove.A</code>, <code>diff.sdMove.A</code> and
<code>hostCount.sdMove.A</code>
</li>
<li><code>attracted.by.raster.A</code></li>
<li>
<code>nContact.A</code> with <code>param.nContact.A</code>,
<code>timeDep.nContact.A</code>, <code>diff.nContact.A</code> and
<code>hostCount.nContact.A</code>
</li>
<li>
<code>pTrans.A</code> with <code>param.pTrans.A</code>,
<code>timeDep.pTrans.A</code>, <code>diff.pTrans.A</code> and
<code>hostCount.pTrans.A</code>
</li>
<li><code>prefix.host.A</code></li>
<li>
<code>pExit.B</code> with <code>param.pExit.B</code>,
<code>timeDep.pExit.B</code>, <code>diff.pExit.B</code> and
<code>hostCount.pExit.B</code>
</li>
<li>
<code>pMove.B</code> with <code>param.pMove.B</code>,
<code>timeDep.pMove.B</code>, <code>diff.pMove.B</code> and
<code>hostCount.pMove.B</code>
</li>
<li>
<code>sdMove.B</code> with <code>param.sdMove.B</code>,
<code>timeDep.sdMove.B</code>, <code>diff.sdMove.B</code> and
<code>hostCount.sdMove.B</code>
</li>
<li><code>attracted.by.raster.B</code></li>
<li>
<code>nContact.B</code> with <code>param.nContact.B</code>,
<code>timeDep.nContact.B</code>, <code>diff.nContact.B</code> and
<code>hostCount.nContact.B</code>
</li>
<li>
<code>pTrans.B</code> with <code>param.pTrans.B</code>,
<code>timeDep.pTrans.B</code>, <code>diff.pTrans.B</code> and
<code>hostCount.pTrans.B</code>
</li>
<li><code>prefix.host.B</code></li>
<li><code>print.progress</code></li>
<li><code>print.step</code></li>
</ul>
<p>As you can see, host-type dependent parameters are now designated by
the suffix <code>.A</code> or <code>.B</code>.</p>
<p>Both <code>max.infected.A</code> and <code>max.infected.B</code> have
to be provided in order to set an upper limit on the simulation size. To
initiate the simulation, you have to provide at least one starting host,
either <code>A</code> or <code>B</code> in
<code>init.individuals.A</code> or <code>init.individuals.B</code>
respectively, as well as a starting position in
<code>init.individuals.A</code> or <code>init.individuals.B</code>,
respectively. If you want to start the simulation with one host only,
then <code>init.individuals</code> of the other can be set to 0 and
<code>init.structure</code> to <code>NA</code>.</p>
<p>A major difference here is that hosts may, or not, share the same
<code>structure.raster</code>. However, since they exist in the same
“world”, they should be in the same coordinate system. It is also
possible to have a host that does not move. In such case,
<code>pMove</code> can be set to <code>NA</code>, as well as
<code>sdMove</code>. In such “non-moving” case, a raster should still be
provided, as it anchors the hosts into the simulation’s world.</p>
<p>Here again, all parameters must be provided for both hosts, although
<code>timeDep</code>, <code>diff</code> and <code>hostCount</code> have
default values set to <code>FALSE</code>; if you do not want to use
these options, then you do not have to explicitly provide a value. Be
careful to switch <code>diff</code> to <code>TRUE</code> if you want to
use <code>hostCount</code>, and remember to provide a result for each
state.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-nosoi">Running <code>nosoi</code><a class="anchor" aria-label="anchor" href="#running-nosoi"></a>
</h2>
<div class="section level3">
<h3 id="single-host">Single host<a class="anchor" aria-label="anchor" href="#single-host"></a>
</h3>
<p>We present here a very simple simulation for a single host
pathogen.</p>
<div class="section level4">
<h4 id="pexit">pExit<a class="anchor" aria-label="anchor" href="#pexit"></a>
</h4>
<p>For <code>pExit</code>, we choose a probability that only depends on
the environmental value of the location where the host currently is. The
maximum value of our environmental raster is close to 70, and the higher
the environmental value is, the less likely the host is to die:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Exit_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&gt;</span> <span class="fl">60</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.02</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&lt;</span> <span class="fl">60</span> <span class="op">&amp;&amp;</span> <span class="va">current.env.value</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.04</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&lt;</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.08</span><span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Taken together, the value for <code>pExit</code> according to the
environmental value will be the following:</p>
<p><img src="continuous_files/figure-html/pExit2-1.png" width="700"></p>
<p>Remember that <code>pExit</code>, like the other core functions has
to be function of <code>t</code>, even if <code>t</code> is not used.
Since <code>pExit</code> is dependent on the location,
<code>diff.pMove=TRUE</code>. However, there is no use of the “absolute”
time of the simulation nor individual-based parameters, so
<code>param.pExit=NA</code>, and <code>timeDep.pExit=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="pmove">pMove<a class="anchor" aria-label="anchor" href="#pmove"></a>
</h4>
<p>We choose a constant value for <code>pMove</code>, namely 0.1,
i.e. an infected host has 10% chance to change its location for each
unit of time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Move_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>Remember that <code>pMove</code>, like the other core functions has
to be function of <code>t</code>, even if <code>t</code> is not used.
Since <code>pMove</code> is not dependent on the location,
<code>diff.pMove=FALSE</code>. Similarly, there is no use of the
“absolute” time of the simulation nor individual-based parameters, so
<code>param.pMove=NA</code>, and <code>timeDep.pMove=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="sdmove">sdMove<a class="anchor" aria-label="anchor" href="#sdmove"></a>
</h4>
<p>We choose a constant value for <code>sdMove</code>, namely 0.25.
<code>sdMove</code> is the standard deviation of the Brownian motion
underlying the movement in <code>nosoi</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd_Move_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>Remember that <code>sdMove</code>, like the other core functions has
to be function of <code>t</code>, even if <code>t</code> is not used.
Since <code>sdMove</code> is not dependent on the location,
<code>diff.pMove=FALSE</code>. Similarly, there is no use of the
“absolute” time of the simulation nor individual-based parameters, so
<code>param.sdMove=NA</code>, and <code>timeDep.sdMove=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="ncontact">nContact<a class="anchor" aria-label="anchor" href="#ncontact"></a>
</h4>
<p>For <code>nContact</code>, we choose a constant function that will
draw a value in a normal distribution of <em>mean</em> = 0.5 and
<em>sd</em> = 1, round it, and take its absolute value.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_contact_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>The distribution of <code>nContact</code> looks as follows:</p>
<p><img src="continuous_files/figure-html/nContact2-1.png" width="700"></p>
<p>At each time and for each infected host, <code>nContact</code> will
be drawn anew. Remember that <code>nContact</code>, like the other core
functions has to be function of <code>t</code>, even if <code>t</code>
is not used. Since <code>nContact</code> is constant here, there is no
use of the “absolute” time of the simulation, the location of the host,
nor individual-based parameters. So <code>param.nContact=NA</code>,
<code>timeDep.nContact=FALSE</code> and
<code>diff.nContact=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="ptrans">pTrans<a class="anchor" aria-label="anchor" href="#ptrans"></a>
</h4>
<p>We choose <code>pTrans</code> in the form of a threshold function:
before a certain amount of time since initial infection, the host does
not transmit (incubation time, which we call <code>t_incub</code>), and
after that time, it will transmit with a certain (constant) probability
(which we call <code>p_max</code>). This function is dependent of the
time since the host’s infection <code>t</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Trans_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">p_max</span>, <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0</span><span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="va">p_max</span><span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Because each host is different (slightly different biotic and abiotic
factors), you can expect each host to exhibit differences in the
dynamics of infection, and hence the probability of transmission over
time. Thus, <code>t_incub</code> and <code>p_max</code> will be sampled
for each host individually according to a certain distribution.
<code>t_incub</code> will be sampled from a normal distribution of <span class="math inline">\(mean\)</span> = 7 and <span class="math inline">\(sd\)</span> = 1, while <code>p_max</code> will be
sampled from a beta distribution with shape parameters <span class="math inline">\(\alpha\)</span> = 5 and <span class="math inline">\(\beta\)</span> = 2:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">7</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>Note that here <code>t_incub</code> and <code>p_max</code> are
functions of <code>x</code> and not <code>t</code> (they are not core
functions but individual-based parameters), and <code>x</code> enters
the function as the number of draws to make.</p>
<p>Taken together, the profile for <code>pTrans</code> for a subset of
200 individuals in the population will look as follows:</p>
<p><img src="continuous_files/figure-html/pTrans3-1.png" width="700"></p>
<p><code>pTrans</code> is not dependent on the “absolute” time of the
simulation, nor on the hosts location, so
<code>timeDep.pTrans=FALSE</code> and <code>diff.pTrans=FALSE</code>.
However, since we make use of individual-based parameters, we have to
provide a <code>param.pTrans</code> as a list of functions. The name of
each element within this list should have the same name that the core
function (here <code>pTrans</code>) uses as argument, e.g.:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">7</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">param_pTrans</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="running">Running<a class="anchor" aria-label="anchor" href="#running"></a>
</h4>
<p>Once <code>nosoiSim</code> is set up, you can run the simulation
(here the “seed” ensures that you will get the same results as in this
tutorial).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slequime/nosoi" class="external-link">nosoi</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Raster is test.raster</span></span>
<span></span>
<span><span class="co">#Starting position will be</span></span>
<span><span class="va">start.pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> <span class="co"># c(x,y)</span></span>
<span></span>
<span><span class="co">#pExit</span></span>
<span><span class="va">p_Exit_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&gt;</span> <span class="fl">60</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.02</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&lt;</span> <span class="fl">60</span> <span class="op">&amp;&amp;</span> <span class="va">current.env.value</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.04</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&lt;</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.08</span><span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#pMove</span></span>
<span><span class="va">p_Move_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#sdMove</span></span>
<span><span class="va">sd_Move_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#nContact</span></span>
<span><span class="va">n_contact_fct</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#pTrans</span></span>
<span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">p_max</span>,<span class="va">t_incub</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="va">p_max</span><span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">param_pTrans</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Starting the simulation ------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">846</span><span class="op">)</span></span>
<span><span class="va">SimulationSingle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"single"</span>, popStructure<span class="op">=</span><span class="st">"continuous"</span>,</span>
<span>                             length.sim<span class="op">=</span><span class="fl">300</span>, max.infected<span class="op">=</span><span class="fl">300</span>, init.individuals<span class="op">=</span><span class="fl">1</span>, </span>
<span>                             </span>
<span>                             init.structure<span class="op">=</span><span class="va">start.pos</span>, </span>
<span>                             </span>
<span>                             structure.raster<span class="op">=</span><span class="va">test.raster</span>,</span>
<span>                             </span>
<span>                             pExit <span class="op">=</span> <span class="va">p_Exit_fct</span>,</span>
<span>                             param.pExit <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                             timeDep.pExit<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             diff.pExit<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                             </span>
<span>                             pMove <span class="op">=</span> <span class="va">p_Move_fct</span>,</span>
<span>                             param.pMove <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                             timeDep.pMove<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             diff.pMove<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             </span>
<span>                             sdMove <span class="op">=</span> <span class="va">sd_Move_fct</span>,</span>
<span>                             param.sdMove <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                             timeDep.sdMove<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             diff.sdMove<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             </span>
<span>                             attracted.by.raster<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             </span>
<span>                             nContact<span class="op">=</span><span class="va">n_contact_fct</span>,</span>
<span>                             param.nContact<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                             timeDep.nContact<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             diff.nContact<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             </span>
<span>                             pTrans <span class="op">=</span> <span class="va">proba</span>,</span>
<span>                             param.pTrans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span>,</span>
<span>                             timeDep.pTrans<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             diff.pTrans<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             </span>
<span>                             prefix.host<span class="op">=</span><span class="st">"H"</span>,</span>
<span>                             print.progress<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                             print.step<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting the simulation</span></span>
<span><span class="co">#&gt; Initializing ... running ...</span></span>
<span><span class="co">#&gt; done. </span></span>
<span><span class="co">#&gt; The simulation has run for 40 units of time and a total of 350 hosts have been infected.</span></span></code></pre></div>
<p>Once the simulation has finished, it reports the number of time units
for which the simulation has run (40), and the maximum number of
infected hosts (350). Note that the simulation has stopped here before
reaching <code>length.sim</code> as it has crossed the
<code>max.infected</code> threshold set at 300.</p>
</div>
</div>
<div class="section level3">
<h3 id="dual-host-1">Dual host<a class="anchor" aria-label="anchor" href="#dual-host-1"></a>
</h3>
<p>Setting up a dual host simulation is similar to the single host
version described above, but each parameter has to be provided for both
hosts. Here, we choose for Host A the same parameters as the single /
only host above. Host B will have sightly different parameters:</p>
<div class="section level4">
<h4 id="pexit-b">pExit.B<a class="anchor" aria-label="anchor" href="#pexit-b"></a>
</h4>
<p>For <code>pExit.B</code>, we choose a value that depends on the
“absolute” time of the simulation, for example cyclic climatic
conditions (temperature). In that case, the function’s arguments should
be <code>t</code> and <code>prestime</code> (the “absolute” time of the
simulation), in that order:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Exit_fctB</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">prestime</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">prestime</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">16</span><span class="op">}</span> <span class="co">#for a periodic function</span></span></code></pre></div>
<p>The values of <code>pExit.B</code> across the “absolute time” of the
simulation will be the following:</p>
<p><img src="continuous_files/figure-html/pExit2-dual-1.png" width="700"></p>
<p>Since <code>pExit.B</code> is dependent on the simulation’s time, do
not forget to set <code>timeDep.pExit.B</code> to <code>TRUE</code>.
Since there are no individual-based parameters nor is there any
influence of the host’s location, <code>param.pExit.B=NA</code> and
<code>diff.pExit.B=NA</code>.</p>
</div>
<div class="section level4">
<h4 id="pmove-b">pMove.B<a class="anchor" aria-label="anchor" href="#pmove-b"></a>
</h4>
<p>We assume here that the hosts B do not move. <code>pMove.B</code>
will hence be set to <code>NA</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Move_fct.B</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Since <code>pMove.B</code> is not dependent on the location,
<code>diff.pMove.B=FALSE</code>. Similarly, there is no use of the
“absolute” time of the simulation nor individual-based parameters, so
<code>param.pMove.B=NA</code>, and
<code>timeDep.pMove.B=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="sdmove-b">sdMove.B<a class="anchor" aria-label="anchor" href="#sdmove-b"></a>
</h4>
<p>Since hosts B do not move, <code>sdMove.B</code> is irrelevant and
will be set to <code>NA</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd_Move_fct.B</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>Since <code>sdMove.B</code> is not dependent on the location,
<code>diff.sdMove.B=FALSE</code>. Similarly, there is no use of the
“absolute” time of the simulation nor individual-based parameters, so
<code>param.sdMove.B=NA</code>, and
<code>timeDep.sdMove.B=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="ncontact-b">nContact.B<a class="anchor" aria-label="anchor" href="#ncontact-b"></a>
</h4>
<p>For <code>nContact.B</code>, we choose a constant function that will
sample a value from a provided list of values, with a certain
probability:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_contact_fct.B</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span>,prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>The distribution of <code>nContact.B</code> looks as follows:</p>
<p><img src="continuous_files/figure-html/nContact2.B-1.png" width="700"></p>
<p>At each time and for each infected host, <code>nContact.B</code> will
be drawn anew. Remember that <code>nContact.B</code>, like the other
core functions has to be function of <code>t</code>, even if
<code>t</code> is not used. Since <code>nContact.B</code> is constant
here, there is no use of the “absolute” time of the simulation, the
host’s location, nor individual-based parameters. So
<code>param.nContact.B=NA</code>, <code>timeDep.nContact.B=FALSE</code>
and <code>diff.nContact.B=FALSE</code>.</p>
</div>
<div class="section level4">
<h4 id="ptrans-b">pTrans.B<a class="anchor" aria-label="anchor" href="#ptrans-b"></a>
</h4>
<p>We choose <code>pTrans.B</code> in the form of a Gaussian function.
It will reach its maximum value at a certain time point (mean) after
initial infection and will subsequently decrease until it reaches 0.</p>
<p>The function <code>dnorm</code> used here will achieve this
objective: for each time <code>t</code> after infection, its return
value will reach its maximum value (&lt; 1) at its mean (here
<code>max.time</code>, a parameter that will be set for each individual,
see below) and then decline back to 0. Its increase and decline is
parameterized by the standard deviation <code>sd</code> of the
<code>dnorm</code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_Trans_fct.B</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">max.time</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">t</span>, mean<span class="op">=</span><span class="va">max.time</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">5</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Because each host is different (slightly different biotic and abiotic
factors), you can expect each host to exhibit differences in the
dynamics of infection, and hence the probability of transmission over
time. Thus, <code>max.time</code> will be sampled for each host
individually according to a certain distribution. <code>max.time</code>
will be sampled from a normal distribution of parameters <span class="math inline">\(mean\)</span> = 5 and <span class="math inline">\(sd\)</span> = 1:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max.time_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>Note again that here <code>max.time</code> is a function of
<code>x</code> and not <code>t</code> (i.e. not a core function but
individual-based parameters), and <code>x</code> enters the function as
the number of draws to make.</p>
<p>Taken together, the profile for <code>pTrans</code> for a subset of
200 individuals in the population will look as follow:</p>
<p><img src="continuous_files/figure-html/pTrans3.B-1.png" width="700"></p>
<p>Since <code>pTrans.B</code> is not dependent of the “absolute” time
of the simulation nor the host’s location,
<code>timeDep.pTrans.B=FALSE</code> and
<code>diff.pTrans.B=FALSE</code>. However, since we have made use of
individual-based parameters, we have to provide a
<code>param.pTrans</code> as a list of functions. The names of each
element of the list should have the same name that the core function
(<code>pTrans.B</code> here) uses as its argument, as shown here:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max.time_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">param_pTrans.B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max.time<span class="op">=</span><span class="va">max.time_fct</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="running-1">Running<a class="anchor" aria-label="anchor" href="#running-1"></a>
</h4>
<p>Once nosoiSim is set up, you can run the simulation (here the “seed”
ensures that you will get the same results as in this tutorial).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slequime/nosoi" class="external-link">nosoi</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Raster is test.raster</span></span>
<span></span>
<span><span class="co">#Starting position will be</span></span>
<span><span class="va">start.pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> <span class="co"># c(x,y)</span></span>
<span></span>
<span><span class="co">#Host A -----------------------------------</span></span>
<span></span>
<span><span class="co">#pExit</span></span>
<span><span class="va">p_Exit_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&gt;</span> <span class="fl">60</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.02</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&lt;</span> <span class="fl">60</span> <span class="op">&amp;&amp;</span> <span class="va">current.env.value</span> <span class="op">&gt;</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.04</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">current.env.value</span> <span class="op">&lt;</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0.08</span><span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#pMove</span></span>
<span><span class="va">p_Move_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#sdMove</span></span>
<span><span class="va">sd_Move_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#nContact</span></span>
<span><span class="va">n_contact_fct</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#pTrans</span></span>
<span><span class="va">proba</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">p_max</span>,<span class="va">t_incub</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0</span><span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="va">p_max</span><span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">param_pTrans</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Host B -----------------------------------</span></span>
<span></span>
<span><span class="co">#pExit</span></span>
<span><span class="va">p_Exit_fct.B</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">prestime</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">prestime</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">16</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#pMove</span></span>
<span><span class="va">p_Move_fct.B</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co">#pMove</span></span>
<span><span class="va">sd_Move_fct.B</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co">#nContact</span></span>
<span><span class="va">n_contact_fct.B</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span>,prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co">#pTrans</span></span>
<span><span class="va">p_Trans_fct.B</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">max.time</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">t</span>, mean<span class="op">=</span><span class="va">max.time</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">5</span></span>
<span><span class="op">}</span></span>
<span> </span>
<span><span class="va">max.time_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">param_pTrans.B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max.time<span class="op">=</span><span class="va">max.time_fct</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Starting the simulation ------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">60</span><span class="op">)</span></span>
<span><span class="va">SimulationDual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"dual"</span>, popStructure<span class="op">=</span><span class="st">"continuous"</span>,</span>
<span>                        length.sim<span class="op">=</span><span class="fl">300</span>, </span>
<span>                        max.infected.A<span class="op">=</span><span class="fl">100</span>,</span>
<span>                        max.infected.B<span class="op">=</span><span class="fl">200</span>,</span>
<span>                        init.individuals.A<span class="op">=</span><span class="fl">1</span>,</span>
<span>                        init.individuals.B<span class="op">=</span><span class="fl">0</span>,</span>
<span>                        init.structure.A<span class="op">=</span><span class="va">start.pos</span>,</span>
<span>                        init.structure.B<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                        structure.raster.A<span class="op">=</span><span class="va">test.raster</span>,</span>
<span>                        structure.raster.B<span class="op">=</span><span class="va">test.raster</span>,</span>
<span></span>
<span>                        pExit.A <span class="op">=</span> <span class="va">p_Exit_fct</span>,</span>
<span>                        param.pExit.A <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                        timeDep.pExit.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.pExit.A<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                        </span>
<span>                        pMove.A <span class="op">=</span> <span class="va">p_Move_fct</span>,</span>
<span>                        param.pMove.A <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                        timeDep.pMove.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.pMove.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        </span>
<span>                        sdMove.A <span class="op">=</span> <span class="va">sd_Move_fct</span>,</span>
<span>                        param.sdMove.A <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                        timeDep.sdMove.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.sdMove.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        attracted.by.raster.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        </span>
<span>                        nContact.A<span class="op">=</span><span class="va">n_contact_fct</span>,</span>
<span>                        param.nContact.A<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                        timeDep.nContact.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.nContact.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span></span>
<span>                        pTrans.A <span class="op">=</span> <span class="va">proba</span>,</span>
<span>                        param.pTrans.A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span>,</span>
<span>                        timeDep.pTrans.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.pTrans.A<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        prefix.host.A<span class="op">=</span><span class="st">"H"</span>,</span>
<span>                        </span>
<span>                        pExit.B <span class="op">=</span> <span class="va">p_Exit_fct.B</span>,</span>
<span>                        param.pExit.B <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                        timeDep.pExit.B<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                        diff.pExit.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        </span>
<span>                        pMove.B <span class="op">=</span> <span class="va">p_Move_fct.B</span>,</span>
<span>                        param.pMove.B <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                        timeDep.pMove.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.pMove.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        </span>
<span>                        sdMove.B <span class="op">=</span> <span class="va">sd_Move_fct.B</span>,</span>
<span>                        param.sdMove.B <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                        timeDep.sdMove.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.sdMove.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        attracted.by.raster.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        </span>
<span>                        nContact.B<span class="op">=</span><span class="va">n_contact_fct.B</span>,</span>
<span>                        param.nContact.B<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                        timeDep.nContact.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.nContact.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span></span>
<span>                        pTrans.B <span class="op">=</span> <span class="va">p_Trans_fct.B</span>,</span>
<span>                        param.pTrans.B <span class="op">=</span> <span class="va">param_pTrans.B</span>,</span>
<span>                        timeDep.pTrans.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        diff.pTrans.B<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                        prefix.host.B<span class="op">=</span><span class="st">"V"</span>,</span>
<span>                        </span>
<span>                        print.progress<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting the simulation</span></span>
<span><span class="co">#&gt; Initializing ... running ...</span></span>
<span><span class="co">#&gt; done. </span></span>
<span><span class="co">#&gt; The simulation has run for 33 units of time and a total of 102 (A) and 137 (B) hosts have been infected.</span></span></code></pre></div>
<p>Once the simulation has finished, it reports the number of time units
for which the simulation has run (33), and the maximum number of
infected hosts A (102) and hosts B (137). Note that the simulation has
stopped here before reaching <code>length.sim</code> as it has crossed
the <code>max.infected.A</code> threshold set at 100.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="going-further">Going further<a class="anchor" aria-label="anchor" href="#going-further"></a>
</h2>
<p>To analyze and visualize your <code>nosoi</code> simulation output,
you can have a look on <a href="https://slequime.github.io/nosoi/articles/examples/viz.html" class="external-link">this
page</a>.</p>
<p>A practical example using a dual host type of simulation with
population structure in a continuous space is also available:</p>
<ul>
<li>
<a href="https://slequime.github.io/nosoi/articles/examples/ebola.html" class="external-link">Spread
of Ebola virus in a continuous space</a>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sebastian Lequime, Paul Bastide, Simon Dellicour, Philippe Lemey, Guy Baele.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
