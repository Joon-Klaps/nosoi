<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spread of a pathogen in a discrete structured population • nosoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spread of a pathogen in a discrete structured population">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nosoi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nosoi.html">
    <span class="fas fa fas fa-play-circle"></span>
     
    Get started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-book"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa fas fa-file"></span>
     
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/ebola.html">Spread of Ebola virus in a continuous space</a>
    </li>
    <li>
      <a href="../articles/vector-competence.html">Epidemiological impact of mosquito vector competence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
    <li>
      <a href="../articles/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/ebola.html">Spread of Ebola virus in a continuous space</a>
    </li>
    <li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/vector-competence.html">Epidemiological impact of mosquito vector competence</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/slequime/nosoi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Spread of a pathogen in a discrete structured population</h1>
                        <h4 class="author">Sebastian Lequime</h4>
            
            <h4 class="date">2019-05-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slequime/nosoi/blob/master/vignettes/discrete.Rmd"><code>vignettes/discrete.Rmd</code></a></small>
      <div class="hidden name"><code>discrete.Rmd</code></div>

    </div>

    
    
<p><code>nosoi</code> can accommodate a wide range of epidemiological transmission scenarios, including structured host populations (in discrete states), such as for example geography (location A, location B, etc.), and allows parameter values to change according to the host’s current location. This tutorial will focus on setting up a <code>nosoi</code> simulation for a single-host pathogen whose host population is structured between different locations.</p>
<div id="single-host-pathogen" class="section level1">
<h1 class="hasAnchor">
<a href="#single-host-pathogen" class="anchor"></a>Single-host pathogen</h1>
<div id="structure-of-the-population" class="section level2">
<h2 class="hasAnchor">
<a href="#structure-of-the-population" class="anchor"></a>Structure of the population</h2>
<p>We will consider here a population of hosts that are in three different locations called “A”, “B” and “C”. Hosts can move (if they undergo a movement event) between these locations with a certain probability you can set or derive from other data. Here, the transition matrix, called here after <code>structure.matrix</code> is:</p>
<pre><code>#&gt;     A   B   C
#&gt; A 0.0 0.5 0.5
#&gt; B 0.2 0.0 0.8
#&gt; C 0.4 0.6 0.0</code></pre>
<p>Which can graphically be represented:</p>
<p><img src="discrete_files/figure-html/setupMatrix-1.png" width="700"></p>
<p>For <code>structure.matrix</code> to be adequate, a few rules have to be followed:</p>
<ul>
<li>
<code>structure.matrix</code> should be of class <code>matrix</code>;</li>
<li>
<code>structure.matrix</code> should have the same number of rows and columns, and they should have the same names;</li>
<li>
<code>structure.matrix</code> rows represents departure state and columns arrival states, the value is the probability from going from departure state to arrival state if movement is undergone, and should thus sum up to 1.</li>
</ul>
<p>##Setting up the simulation</p>
<p>As we have seen <a href="none.html#setting-up-the-simulation">before</a> , the wrapper function <code>nosoiSim</code> takes all the arguments that will be passed down to the core function, in the case of this tutorial: <code>singleDiscrete</code> (for “single host, discrete population structure”). We thus start by providing the options <code>type="single"</code> and <code>structure=TRUE</code> to set up the analysis:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">SimulationB &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">structure=</span><span class="ot">TRUE</span>, ...)</a></code></pre></div>
<p>This simulation (<code>singleNone</code>) type takes several arguments or options to be able to run, namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected</code></li>
<li><code>init.individuals</code></li>
<li><code>init.structure</code></li>
<li><code>structure.matrix</code></li>
<li>
<code>pExit</code> with <code>param.pExit</code>, <code>diff.pExit</code> and <code>timeDep.pExit</code>
</li>
<li>
<code>pMove</code> with <code>param.pMove</code>, <code>diff.pMove</code> and <code>timeDep.pMove</code>
</li>
<li>
<code>nContact</code> with <code>param.nContact</code>, <code>diff.nContact</code> and <code>timeDep.nContact</code>
</li>
<li>
<code>pTrans</code> with <code>param.pTrans</code>, <code>diff.pTrans</code> and <code>timeDep.pTrans</code>
</li>
<li><code>prefix.host</code></li>
<li><code>progress.bar</code></li>
<li><code>print.step</code></li>
</ul>
<p>All the <code>param</code> elements provide individual-level parameters to be taken into account; the <code>diff</code> elements inform the simulator if there is a differential probability according to the state the host is currently in and the <code>timeDep</code> elements inform the simulator if the “absolute” simulation time should be taken into account.</p>
<div id="general-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#general-parameters" class="anchor"></a>General parameters</h3>
<p><code>length.sim</code> and <code>max.infected</code> are general parameters that define the simulation: <code>length.sim</code> is the maximum number of time units (e.g. days, months, years, or another time unit of choice) during which the simulation will be run, whereas <code>max.infected</code> is the maximum number of individuals that can be infected during the simulation. The simulation will thus run until either the time limit or the maximum number of infected individuals is reached.</p>
<p><code>init.individuals</code> and <code>init.structure</code> are the “seeding parameters”. <code>init.individuals</code> defines the number of individuals (starting at 1, should be an integer) that will start a transmission chain and <code>init.structure</code> their original location in the structured population (has to be the same original location for all starting individuals). Keep in mind that you will have as many transmission chains as initial individuals, which is equivalent as launching two independant <code>nosoi</code> simulations. The location provided in <code>init.structure</code> should of course be present in the <code>structure.matrix</code>.</p>
<p>Here, we will run a simulation starting with 1 individual in state “A”, for a maximum of 1.000 infected individuals and a maximum time of 300 days.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">structure=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                        <span class="dt">length.sim=</span><span class="dv">300</span>, <span class="dt">max.infected=</span><span class="dv">1000</span>, <span class="dt">init.individuals=</span><span class="dv">1</span>, <span class="dt">init.structure=</span><span class="st">"A"</span>, ...)</a></code></pre></div>
</div>
<div id="core-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#core-functions" class="anchor"></a>Core functions</h3>
<p>The core functions <code>pExit</code>, <code>nContact</code> and <code>pTrans</code> each follow the same principles to be set up (<a href="nosoi.html#essential-building-blocs-3-probabilities-and-2-numbers">see General principles</a> and <a href="get-started.html#setting-up-the-core-functions">see Get started</a> for more details). To accommodate several scenarios, they can be constant, time-dependent (relative time since infection for each individual or “absolute”" time of the simulation), the host’s current location, or even individually parameterized, to include some stochasticity at the individual host level. In every case, the function provided, like all other core function in <code>nosoi</code>, has to be expressed as function of time <code>t</code>, even if time is not used to compute the probability. In case the function uses individual-based parameters, you have to specify a list of functions (called <code>param.pExit</code>, <code>param.nContact</code> or <code>param.pTrans</code>) ( <a href="get-started.html#parameters">see Get started</a> ). If no individual-based parameter is used, then <code>param.pExit</code> is <code>NA</code>.</p>
<blockquote>
<p>Keep in mind that <code>pExit</code>, <code>pMove</code> and <code>pTrans</code> have to give back a probability (i.e. a number between 0 and 1) while <code>nContact</code> should give back a positive natural number (positive integer).</p>
</blockquote>
<p>You can combine the influence of several parameters, such as time since infection, “absolute” time of the simulation, the hosts current location and individual-based parameters within the same function.</p>
<blockquote>
<p>Time since infection, “absolute” time and current location should ALWAYS be designated by <code>t</code>, <code>prestime</code> and <code>current.in</code> respectively, and be in that order and first of the function parameters.</p>
</blockquote>
<div id="pexit-param-pexit-timedep-pexit-diff-pexit" class="section level4">
<h4 class="hasAnchor">
<a href="#pexit-param-pexit-timedep-pexit-diff-pexit" class="anchor"></a><code>pExit</code>, <code>param.pExit</code>, <code>timeDep.pExit</code>, <code>diff.pExit</code>
</h4>
<p><code>pExit</code> is the first required fundamental parameter and provides a probability (per unit of time) for a host to leave the simulation (either cured, died, etc.).</p>
<p>Here are some possible functions for <code>pExit</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.08</span>)} <span class="co">#as a constant</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">plogis</a></span>(t,<span class="dv">20</span>,<span class="dv">2</span>)} <span class="co">#as a time-since infection dependent function</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,pExit.param1){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">plogis</a></span>(t,pExit.param1,<span class="dv">2</span>)} <span class="co">#as a time-since infection dependent function with an individually parameter</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">p_exit_param1 &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">10</span>,<span class="dt">sd=</span><span class="dv">2</span>)} <span class="co">#sampling one parameter for each infected individual</span></a></code></pre></div>
<p>Here are some possible values for <code>param.pExit</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">param.pExit=<span class="ot">NA</span> <span class="co">#without individual-based parameter</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">param.pExit=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">pExit.param1=</span>p_exit_param1) <span class="co">#with 1 individua-based parameter</span></a></code></pre></div>
<p><code>timeDep.pExit</code> allows for <code>pExit</code> to be dependant of the “absolute” time of the simulation, to account, for example, for seasonality or other external time related covariates. By default, <code>timeDep.pExit</code> is set to <code>FALSE</code>. Here is a possible functions for <code>pExit</code> when <code>timeDep.pExit = TRUE</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,prestime){(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(prestime<span class="op">/</span><span class="dv">12</span>)<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>} <span class="co">#for a periodic function</span></a></code></pre></div>
<p><code>diff.pExit</code> informs the simulator if <code>pExit</code> is dependant of the host’s current state within the structured population. By default, <code>diff.pExit</code> is <code>FALSE</code>. Here is a possible functions for <code>pExit</code> when <code>diff.pExit = TRUE</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,current.in){</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"A"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"B"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.5</span>)}</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"C"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="dv">1</span>)}}</a></code></pre></div>
<p>In that case, every state possible should be taken into account. You can of course also have an individually parameterized <code>pExit</code>, being both dependant of the time since infection (<code>t</code>) and “absolute” time (<code>prestime</code>), such as:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,prestime,pExit.param1){((<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(prestime<span class="op">/</span><span class="dv">12</span>)<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">plogis</a></span>(t,pExit.param1,<span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">p_exit_param1 &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">10</span>,<span class="dt">sd=</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">param.pExit=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">pExit.param1=</span>p_exit_param1)</a></code></pre></div>
</div>
<div id="pmove-param-pmove-timedep-pmove-and-diff-pmove" class="section level4">
<h4 class="hasAnchor">
<a href="#pmove-param-pmove-timedep-pmove-and-diff-pmove" class="anchor"></a><code>pMove</code>, <code>param.pMove</code>, <code>timeDep.pMove</code> and <code>diff.pMove</code>
</h4>
<p><code>pMove</code> is the probability (per unit of time) for a host to move to a different state (for example, leaving state “A”). It should not be confused with the probabilities extracted from the <code>structure.matrix</code>, which represent the probability to go to a specific location once a movement is ongoing (for example, going to “B” or “C” while coming from “A”). Here are some examples:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)} <span class="co">#a constant</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">plogis</a></span>(t,<span class="dv">20</span>,<span class="dv">2</span>)} <span class="co">#as a time-since infection dependent function</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,prestime){(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">sin</a></span>(prestime<span class="op">/</span><span class="dv">12</span>)<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>} <span class="co">#as "absolute"-time dependant.</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,current.in){</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"A"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)}</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"B"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"C"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.2</span>)}</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">} <span class="co">#location dependent</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,pExit.param1){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Logistic">plogis</a></span>(t,pMove.param1,<span class="dv">2</span>)} <span class="co">#as a time-since infection dependent function with an individually parameter</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">p_move_param1 &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">10</span>,<span class="dt">sd=</span><span class="dv">2</span>)} <span class="co">#sampling one parameter for each infected individual</span></a></code></pre></div>
<p>For a constant or time-dependent function, with no individual parameter, <code>param.pMove</code> is <code>NA</code>. In the case of an individually parameterized <code>pMove</code>, the functions for the parameters have to be wrapped into a list, called <code>param.pMove</code>. As with <code>pExit</code>, <code>pMove</code> can be dependant of the “absolute” time of the simulation by turning <code>timeDep.pMove = TRUE</code> and/or dependant of the current position of the host if <code>diff.pExit = TRUE</code>. General recommandations (order of the arguments, etc) apply here too.</p>
</div>
<div id="ncontact-param-ncontact-timedep-ncontact-and-diff-ncontact" class="section level4">
<h4 class="hasAnchor">
<a href="#ncontact-param-ncontact-timedep-ncontact-and-diff-ncontact" class="anchor"></a><code>nContact</code>, <code>param.nContact</code>, <code>timeDep.nContact</code> and <code>diff.nContact</code>
</h4>
<p><code>nContact</code> represents the number (a positive integer) of potentially infectious contacts an infected hosts can encounter per unit of time. At each time point, a number of contacts will be determined for each active host in the simulation. The number of contacts (i.e. the output of your function) has to be an integer and can be set to zero. Like every core functions, it has to be be expressed as a function of <code>t</code> (the time since infection), but it can take various forms. Here are some examples:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="dv">2</span>)} <span class="co">#to get a constant number of contacts for each hosts, here 2.</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">1</span>,<span class="dt">prob=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.1</span>))} <span class="co">#to get a varying number of contacts for each hosts.</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>), <span class="dv">0</span>)} <span class="co">#another example of varying number of contacts for each hosts.</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">n_contact_fct =<span class="st"> </span><span class="cf">function</span>(t,prestime){</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  <span class="cf">if</span>(prestime <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">1</span>), <span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  <span class="cf">if</span>(prestime <span class="op">&gt;=</span><span class="st"> </span><span class="dv">10</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>), <span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">} <span class="co">#for an absolute time dependent value</span></a></code></pre></div>
<p>For a constant or time-dependent function, with no individual parameter, <code>param.nContact</code> is <code>NA</code>. In the case of an individually parameterized <code>nContact</code>, the functions for the parameters have to be wrapped into a list, called <code>param.nContact</code>. As with <code>pExit</code>, <code>nContact</code> can be dependant of the “absolute” time of the simulation by turning <code>timeDep.nContact = TRUE</code> and/or dependant of the current position of the host if <code>diff.nContact = TRUE</code>. General recommandations (order of the arguments, etc) apply here too.</p>
</div>
<div id="ptrans-param-ptrans-timedep-ptrans-and-diff-ptrans" class="section level4">
<h4 class="hasAnchor">
<a href="#ptrans-param-ptrans-timedep-ptrans-and-diff-ptrans" class="anchor"></a><code>pTrans</code>, <code>param.pTrans</code>, <code>timeDep.pTrans</code> and <code>diff.pTrans</code>
</h4>
<p>The <code>pTrans</code> function is the heart of the transmission process and represents the probability of transmission over time (when a contact occurs). This function returns the probability (i.e. a value between 0 and 1) dependent on the time (<code>t</code>) since the host’s infection. It is intended to work with a set of parameters (at least 1) defined by <code>param.pTrans</code>, that will characterize the dynamics of the transmission probability over time, as well as introducing some individual based stochasticity. Since each host is different (because of slightly different biotic and abiotic factors), you can expect each host to show differences in the dynamics of infection, and hence probability of transmission over time. The parameters defined in <code>param.pTrans</code> are hence also functions that will sample parameter values (<code>param.pTrans</code> is a list of functions). <code>timeDep.pTrans</code> allows for <code>pTrans</code> to be dependant of the “absolute time” of the simulation, to account, for example, for seasonality or other external time related covariates. <code>diff.pTrans</code> allows for <code>pTrans</code> to be dependant of the host’s location.</p>
<p>As an example, let’s consider the following function for <code>pTrans</code>, in the form of a threshold function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">proba &lt;-<span class="st"> </span><span class="cf">function</span>(t,p_max,t_incub){</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">    <span class="cf">if</span>(t <span class="op">&lt;</span><span class="st"> </span>t_incub){p=<span class="dv">0</span>}</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">    <span class="cf">if</span>(t <span class="op">&gt;=</span><span class="st"> </span>t_incub){p=p_max}</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">}</a></code></pre></div>
<p>This function returns a transmission probability <code>p</code> given the time since infection <code>t</code> and two parameters, <code>p_max</code>, the maximum transmission probability and <code>t_incub</code>, the length of the incubation period (the threshold). If <code>t</code> is bigger than <code>t_incub</code>, then the transmission probability is <code>p_max</code>; if not, it is equal to 0.</p>
<p><code>p_max</code> and <code>t_incub</code> need to be specified. If we fix the values, for example to 0.8 and 5 units of time respectively, we assume that each host will react the same to the infection, as if they were perfect clones. To more accurately match reality, <code>nosoi</code> forces you to sample the values of each parameters from a function, such as:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">p_max_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(x,<span class="dt">shape1 =</span> <span class="dv">5</span>,<span class="dt">shape2=</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a></code></pre></div>
<p>Here, <code>p_max</code> will be sampled from a beta distribution, with shape parameters 5 and 2, and <code>t_incub</code> will be sampled from a Gaussian distribution, with mean 5 and standard deviation 1. <code>x</code> will be the number of draws to perform. If you want to fix the value of one or all parameters, you can use a sampling function that will always give you the same value, such as:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">5</span>,x)} <span class="co">#constant parameter value.</span></a></code></pre></div>
<p>In any case, the functions for <code>pTrans</code> parameters have to be wrapped into a list, called <code>param.pTrans</code>. The name of each function in the list has to have the same name as the parameter it is sampling for <code>pTrans</code>. Here, it will look like:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct, <span class="dt">t_incub=</span>t_incub_fct)</a></code></pre></div>
<p>At this step, the <code>nosoi</code> function should look something like this:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">structure=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">                        <span class="dt">length.sim=</span><span class="dv">300</span>, <span class="dt">max.infected=</span><span class="dv">1000</span>, <span class="dt">init.individuals=</span><span class="dv">1</span>, <span class="dt">init.structure=</span><span class="st">"A"</span>, </a>
<a class="sourceLine" id="cb15-3" data-line-number="3">                        </a>
<a class="sourceLine" id="cb15-4" data-line-number="4">                        <span class="dt">diff.pExit=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">                        <span class="dt">pExit =</span> p_Exit_fct,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">                        <span class="dt">param.pExit =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">                        <span class="dt">timeDep.pExit=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">                        </a>
<a class="sourceLine" id="cb15-9" data-line-number="9">                        <span class="dt">diff.pMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">                        <span class="dt">pMove =</span> p_Exit_fct,</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">                        <span class="dt">param.pMove =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">                        <span class="dt">timeDep.pMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">                        </a>
<a class="sourceLine" id="cb15-14" data-line-number="14">                        </a>
<a class="sourceLine" id="cb15-15" data-line-number="15">                        <span class="dt">diff.nContact=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">                        <span class="dt">nContact=</span>n_contact_fct,</a>
<a class="sourceLine" id="cb15-17" data-line-number="17">                        <span class="dt">param.nContact=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">                        <span class="dt">timeDep.nContact=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-19" data-line-number="19"> </a>
<a class="sourceLine" id="cb15-20" data-line-number="20">                        <span class="dt">diff.pTrans=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">                        <span class="dt">pTrans =</span> proba,</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">                        <span class="dt">param.pTrans =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct),</a>
<a class="sourceLine" id="cb15-23" data-line-number="23">                        <span class="dt">timeDep.pTrans=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">                        ...)</a></code></pre></div>
</div>
</div>
<div id="miscellaneous" class="section level3">
<h3 class="hasAnchor">
<a href="#miscellaneous" class="anchor"></a>Miscellaneous</h3>
<p><code>prefix.host</code> allows you to define the first character(s) for the hosts’ unique ID. It will be followed by a hyphen and a unique number. By default, <code>prefix.host</code> is “H” for “Host”.</p>
<p><code>progress.bar</code> allows you to get some information printed on the screen about the simulation while running. It will print something every <code>print.step</code>. By default, <code>progress.bar</code> is activated, with a <code>print.step = 10</code> (that you can change), but you may want to deactivate it by providing <code>progress.bar == FALSE</code>.</p>
</div>
</div>
<div id="running-nosoi" class="section level2">
<h2 class="hasAnchor">
<a href="#running-nosoi" class="anchor"></a>Running Nosoi</h2>
<p>Once nosoiSim is set up, you can run the simulation (here the “seed” ensures that you will get the same results as in this tutorial).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nosoi)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co">#&gt; Loading required package: data.table</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">p_Exit_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t,current.in){</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"A"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.02</span>)}</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"B"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.05</span>)}</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  <span class="cf">if</span>(current.in<span class="op">==</span><span class="st">"C"</span>){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)}}</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"></a>
<a class="sourceLine" id="cb16-9" data-line-number="9">p_Move_fct  &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(<span class="fl">0.1</span>)}</a>
<a class="sourceLine" id="cb16-10" data-line-number="10"></a>
<a class="sourceLine" id="cb16-11" data-line-number="11">time_contact_fct &lt;-<span class="st"> </span><span class="cf">function</span>(t){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sample">sample</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dt">prob=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.8</span>,<span class="fl">0.15</span>,<span class="fl">0.05</span>))}</a>
<a class="sourceLine" id="cb16-12" data-line-number="12"></a>
<a class="sourceLine" id="cb16-13" data-line-number="13">proba &lt;-<span class="st"> </span><span class="cf">function</span>(t,p_max,t_incub){</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">  <span class="cf">if</span>(t <span class="op">&lt;=</span><span class="st"> </span>t_incub){p=<span class="dv">0</span>}</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">  <span class="cf">if</span>(t <span class="op">&gt;=</span><span class="st"> </span>t_incub){p=p_max}</a>
<a class="sourceLine" id="cb16-16" data-line-number="16">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(p)</a>
<a class="sourceLine" id="cb16-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb16-18" data-line-number="18"></a>
<a class="sourceLine" id="cb16-19" data-line-number="19">t_incub_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(x,<span class="dt">mean =</span> <span class="dv">5</span>,<span class="dt">sd=</span><span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb16-20" data-line-number="20">p_max_fct &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Beta">rbeta</a></span>(x,<span class="dt">shape1 =</span> <span class="dv">5</span>,<span class="dt">shape2=</span><span class="dv">2</span>)}</a>
<a class="sourceLine" id="cb16-21" data-line-number="21"></a>
<a class="sourceLine" id="cb16-22" data-line-number="22">transition.matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">0</span>),<span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>,<span class="dt">dimnames=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>)))</a>
<a class="sourceLine" id="cb16-23" data-line-number="23"></a>
<a class="sourceLine" id="cb16-24" data-line-number="24"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">846</span>)</a>
<a class="sourceLine" id="cb16-25" data-line-number="25">SimulationA &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nosoiSim.html">nosoiSim</a></span>(<span class="dt">type=</span><span class="st">"single"</span>, <span class="dt">structure=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-26" data-line-number="26">                        <span class="dt">length.sim=</span><span class="dv">300</span>, <span class="dt">max.infected=</span><span class="dv">300</span>, <span class="dt">init.individuals=</span><span class="dv">1</span>, <span class="dt">init.structure=</span><span class="st">"A"</span>, </a>
<a class="sourceLine" id="cb16-27" data-line-number="27">                        </a>
<a class="sourceLine" id="cb16-28" data-line-number="28">                        <span class="dt">structure.matrix=</span>transition.matrix,</a>
<a class="sourceLine" id="cb16-29" data-line-number="29">                        </a>
<a class="sourceLine" id="cb16-30" data-line-number="30">                        <span class="dt">diff.pExit=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-31" data-line-number="31">                        <span class="dt">pExit =</span> p_Exit_fct,</a>
<a class="sourceLine" id="cb16-32" data-line-number="32">                        <span class="dt">param.pExit =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb16-33" data-line-number="33">                        <span class="dt">timeDep.pExit=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-34" data-line-number="34">                        </a>
<a class="sourceLine" id="cb16-35" data-line-number="35">                        <span class="dt">diff.pMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-36" data-line-number="36">                        <span class="dt">pMove =</span> p_Move_fct,</a>
<a class="sourceLine" id="cb16-37" data-line-number="37">                        <span class="dt">param.pMove =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb16-38" data-line-number="38">                        <span class="dt">timeDep.pMove=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-39" data-line-number="39">                        </a>
<a class="sourceLine" id="cb16-40" data-line-number="40">                        </a>
<a class="sourceLine" id="cb16-41" data-line-number="41">                        <span class="dt">diff.nContact=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-42" data-line-number="42">                        <span class="dt">nContact=</span>time_contact_fct,</a>
<a class="sourceLine" id="cb16-43" data-line-number="43">                        <span class="dt">param.nContact=</span><span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb16-44" data-line-number="44">                        <span class="dt">timeDep.nContact=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-45" data-line-number="45"> </a>
<a class="sourceLine" id="cb16-46" data-line-number="46">                        <span class="dt">diff.pTrans=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-47" data-line-number="47">                        <span class="dt">pTrans =</span> proba,</a>
<a class="sourceLine" id="cb16-48" data-line-number="48">                        <span class="dt">param.pTrans =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">p_max=</span>p_max_fct,<span class="dt">t_incub=</span>t_incub_fct),</a>
<a class="sourceLine" id="cb16-49" data-line-number="49">                        <span class="dt">timeDep.pTrans=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-50" data-line-number="50">                      </a>
<a class="sourceLine" id="cb16-51" data-line-number="51">                        <span class="dt">prefix.host=</span><span class="st">"H"</span>,</a>
<a class="sourceLine" id="cb16-52" data-line-number="52">                        <span class="dt">progress.bar=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb16-53" data-line-number="53">                        <span class="dt">print.step=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb16-54" data-line-number="54"><span class="co">#&gt; Starting the simulation</span></a>
<a class="sourceLine" id="cb16-55" data-line-number="55"><span class="co">#&gt; Initializing ...</span></a>
<a class="sourceLine" id="cb16-56" data-line-number="56"><span class="co">#&gt;  running ...</span></a>
<a class="sourceLine" id="cb16-57" data-line-number="57"><span class="co">#&gt; done. </span></a>
<a class="sourceLine" id="cb16-58" data-line-number="58"><span class="co">#&gt; The simulation has run for 134 units of time and a total of 321 hosts have been infected.</span></a></code></pre></div>
<p>Once the simulation is finished, it reports the number of time units for which the simulation has run (134), and the maximum number of infected hosts (321). Note that the simulation has stopped here before reaching <code>length.sim</code> as it has crossed the <code>max.infected</code> threshold set at 1000.</p>
</div>
<div id="nosoi-output" class="section level2">
<h2 class="hasAnchor">
<a href="#nosoi-output" class="anchor"></a>Nosoi output</h2>
<p><code>nosoi</code> gives as its output a list contaning a <code>data.table</code> (a more efficient version of a <code>data.frame</code>) called <code>table.hosts</code> with the following structure:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(SimulationA<span class="op">$</span>table.hosts)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="co">#&gt;    hosts.ID inf.by inf.in current.in inf.time out.time active     p_max</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="co">#&gt; 1:      H-1   NA-1      A          B        0       15      0 0.8305929</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co">#&gt; 2:     H-10    H-6      C          C       33       40      0 0.6069331</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; 3:    H-100   H-82      B          C      104      133      0 0.4952356</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; 4:    H-101   H-59      A          C      105      113      0 0.6939837</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt; 5:    H-102   H-63      C          C      105      107      0 0.8005005</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt; 6:    H-103   H-65      C          C      105      112      0 0.6983221</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt;     t_incub</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt; 1: 7.203268</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt; 2: 4.729960</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#&gt; 3: 5.931511</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="co">#&gt; 4: 4.600505</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">#&gt; 5: 6.713453</span></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">#&gt; 6: 4.733850</span></a></code></pre></div>
<p>Each individual host that was or is infected during the course of the simulation is a line in the data.table. <code>hosts.ID</code> is the unique identifier of the host, while <code>inf.by</code> indicates which host infected it. As you can see, host <code>H-1</code> has been infected by <code>NA</code>; <code>H-1</code> is the individual that started the transmission chain. <code>inf.in</code> indicates where the host has been infected, and <code>current.in</code> indicates where the host is at his end of the simulation (either when it exited the simulation or the simulation ended). <code>inf.time</code> is the time (in simulation units of time) when the host has been infected, and <code>out.time</code> is the time (in simulation units of time) when it left the simulation. Here in the top 6 lines, no host has left the simulation (it ran only for 13 units of time). <code>active</code> indicates if the host is still active in the simulation. <code>p_max</code> and <code>t_incub</code> are the individually sampled parameters for <code>pTrans</code>.</p>
<p>The output also contains a <code>data.table</code> (a more efficient version of a <code>data.frame</code>) called <code>table.state</code>, containing the full transition history for each hosts between the states. It has the following structure:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(SimulationA<span class="op">$</span>table.state)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="co">#&gt;    hosts.ID state time.from time.to</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#&gt; 1:      H-1     A         0       7</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4"><span class="co">#&gt; 2:      H-1     C         7      13</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt; 3:      H-1     B        13      15</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; 4:     H-10     C        33      40</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; 5:    H-100     B       104     105</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; 6:    H-100     C       105     107</span></a></code></pre></div>
<p><code>hosts.ID</code> is the unique identifier of the host. If we take the example of the host “H-1”, we can see that it was present at <code>state</code> “A” (the initial state), from time 0 (<code>time.from</code>) to 7 (<code>time.to</code>), then it moved to state “C” where it stayed until time 13 and then it moved to state “B” where it stayed until time 15. The previous table (<code>table.hosts</code>), informs us that the host “H-1” exited the simulation at time 15.</p>
</div>
<div id="visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#visualisation" class="anchor"></a>Visualisation</h2>
<p>The transmission chain can be visualized using some of the packages dealing with networks in R. I typically use <code>igraph</code> with <code>ggnetwork</code>, but this is really up to you. Keep in mind that the more nodes (i.e. infected hosts) you have, the more messy (or difficult) the visualisation will be.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(viridis)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggnetwork)</a>
<a class="sourceLine" id="cb19-5" data-line-number="5"></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co"># To show the graph, we need to invert column 1 and 2, and discard the first line (i.e. the first host, </span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co"># because it shows "NA" as infecting host). We then provide *Nosoi* output as elements for the vertices (nodes).</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8">graph.simA &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph.data.frame</a></span>(SimulationA<span class="op">$</span>table.hosts[<span class="op">-</span><span class="dv">1</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">1</span>)],<span class="dt">directed=</span>T,<span class="dt">vertices =</span> SimulationA<span class="op">$</span>table.hosts)</a>
<a class="sourceLine" id="cb19-9" data-line-number="9"></a>
<a class="sourceLine" id="cb19-10" data-line-number="10">graph.simA.network =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggnetwork/topics/ggnetwork">ggnetwork</a></span>(graph.simA, <span class="dt">layout =</span> <span class="st">"kamadakawai"</span>, <span class="dt">cell.jitter =</span> <span class="fl">0.75</span>) <span class="co">#using ggnetwork to provide the layout</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#plotting the network</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(graph.simA.network, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">xend =</span> xend, <span class="dt">yend =</span> yend)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggnetwork/topics/geom_edges">geom_edges</a></span>(<span class="dt">color =</span> <span class="st">"grey70"</span>,<span class="dt">arrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/reexports">arrow</a></span>(<span class="dt">length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/reexports">unit</a></span>(<span class="fl">0.3</span>, <span class="st">"lines"</span>), <span class="dt">type =</span> <span class="st">"open"</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggnetwork/topics/geom_nodes">geom_nodes</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color=</span>inf.in)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/scale_viridis">scale_color_viridis</a></span>(<span class="dt">name=</span><span class="st">"State when infected"</span>,<span class="dt">discrete =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggnetwork/topics/theme_blank">theme_blank</a></span>()</a></code></pre></div>
<p><img src="discrete_files/figure-html/visualisation-1.png" width="700"></p>
<p>The following animated plot shows the number of infected host per state per unit of time, as well as movement events between state at said unit of time.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co">#Packages needed:</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(viridis)</a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(igraph)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggnetwork)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gganimate)</a>
<a class="sourceLine" id="cb20-8" data-line-number="8"></a>
<a class="sourceLine" id="cb20-9" data-line-number="9"><span class="co">#Getting the layout for the states (as above)</span></a>
<a class="sourceLine" id="cb20-10" data-line-number="10"></a>
<a class="sourceLine" id="cb20-11" data-line-number="11">transition.matrix =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="dv">0</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">0</span>),<span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>,<span class="dt">dimnames=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span>)))</a>
<a class="sourceLine" id="cb20-12" data-line-number="12"></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">melted.transition.matrix &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(transition.matrix, <span class="dt">varnames =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"from"</span>,<span class="st">"to"</span>),<span class="dt">value.name=</span><span class="st">"prob"</span>, <span class="dt">as.is =</span> <span class="ot">TRUE</span>) <span class="co">#melting the matrix go get from -&gt; to in one line with probability</span></a>
<a class="sourceLine" id="cb20-14" data-line-number="14"></a>
<a class="sourceLine" id="cb20-15" data-line-number="15">melted.transition.matrix =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/subset">subset</a></span>(melted.transition.matrix, prob<span class="op">!=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb20-16" data-line-number="16"></a>
<a class="sourceLine" id="cb20-17" data-line-number="17">graph.Matrix &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph.data.frame</a></span>(melted.transition.matrix,<span class="dt">directed=</span>T)</a>
<a class="sourceLine" id="cb20-18" data-line-number="18"></a>
<a class="sourceLine" id="cb20-19" data-line-number="19">layout =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggnetwork/topics/ggnetwork">ggnetwork</a></span>(graph.Matrix, <span class="dt">layout =</span> <span class="st">"circle"</span>,<span class="dt">arrow.gap=</span><span class="fl">0.18</span>)[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)] <span class="co">#using ggnetwork to provide the layout</span></a>
<a class="sourceLine" id="cb20-20" data-line-number="20"></a>
<a class="sourceLine" id="cb20-21" data-line-number="21"><span class="co">#Loading data from the simulation</span></a>
<a class="sourceLine" id="cb20-22" data-line-number="22"></a>
<a class="sourceLine" id="cb20-23" data-line-number="23">test =<span class="st"> </span>SimulationA<span class="op">$</span>table.state</a>
<a class="sourceLine" id="cb20-24" data-line-number="24"></a>
<a class="sourceLine" id="cb20-25" data-line-number="25"><span class="co">#Loop to get the number of infected in each state per unit of time</span></a>
<a class="sourceLine" id="cb20-26" data-line-number="26">results=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb20-27" data-line-number="27"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(test<span class="op">$</span>time.from)) {</a>
<a class="sourceLine" id="cb20-28" data-line-number="28">  temp =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/subset">subset</a></span>(test, time.from <span class="op">&lt;=</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(time.to <span class="op">&gt;</span><span class="st"> </span>i <span class="op">|</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/NA">is.na</a></span>(time.to)))[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"hosts.ID"</span>,<span class="st">"state"</span>)]</a>
<a class="sourceLine" id="cb20-29" data-line-number="29">  temp<span class="op">$</span>time =<span class="st"> </span>i</a>
<a class="sourceLine" id="cb20-30" data-line-number="30">  results=data.table<span class="op">::</span><span class="kw">rbindlist</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(temp),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(results)))</a>
<a class="sourceLine" id="cb20-31" data-line-number="31">}</a>
<a class="sourceLine" id="cb20-32" data-line-number="32"></a>
<a class="sourceLine" id="cb20-33" data-line-number="33">test2 =<span class="st"> </span>results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(time,state) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">N=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(hosts.ID)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(layout,<span class="dt">by=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"state"</span>=<span class="st">"vertex.names"</span>))</a>
<a class="sourceLine" id="cb20-34" data-line-number="34"></a>
<a class="sourceLine" id="cb20-35" data-line-number="35"><span class="co">#Loop to get the transitions between states and their time</span></a>
<a class="sourceLine" id="cb20-36" data-line-number="36">results2=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb20-37" data-line-number="37"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(test<span class="op">$</span>hosts.ID)) {</a>
<a class="sourceLine" id="cb20-38" data-line-number="38">  subset.current =<span class="st"> </span>test[i]</a>
<a class="sourceLine" id="cb20-39" data-line-number="39">  <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(subset.current) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb20-40" data-line-number="40">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(subset.current)<span class="op">-</span><span class="dv">1</span>)){</a>
<a class="sourceLine" id="cb20-41" data-line-number="41">    temp =<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">hosts.ID=</span>i,<span class="dt">time=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(subset.current[j]<span class="op">$</span>time.to),<span class="dt">from=</span>subset.current[j]<span class="op">$</span>state,<span class="dt">to=</span>subset.current[j<span class="op">+</span><span class="dv">1</span>]<span class="op">$</span>state)</a>
<a class="sourceLine" id="cb20-42" data-line-number="42">   results2=data.table<span class="op">::</span><span class="kw">rbindlist</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(temp),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(results2)))</a>
<a class="sourceLine" id="cb20-43" data-line-number="43">    }}}</a>
<a class="sourceLine" id="cb20-44" data-line-number="44"></a>
<a class="sourceLine" id="cb20-45" data-line-number="45">test3 =<span class="st"> </span>results2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(time,from,to) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">N=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(hosts.ID)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(layout,<span class="dt">by=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"from"</span>=<span class="st">"vertex.names"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(layout,<span class="dt">by=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"to"</span>=<span class="st">"vertex.names"</span>),<span class="dt">suffix=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"from"</span>,<span class="st">"to"</span>))</a>
<a class="sourceLine" id="cb20-46" data-line-number="46"></a>
<a class="sourceLine" id="cb20-47" data-line-number="47"><span class="co">#Animated plot (using gganimate):</span></a>
<a class="sourceLine" id="cb20-48" data-line-number="48">animated.plot =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb20-49" data-line-number="49"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">data=</span>test2,<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(x,y, <span class="dt">color=</span>state,<span class="dt">size=</span>N)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-50" data-line-number="50"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_segment">geom_curve</a></span>(<span class="dt">data=</span>test3, <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>xfrom,<span class="dt">y=</span>yfrom,<span class="dt">xend=</span>xto,<span class="dt">yend=</span>yto),<span class="dt">arrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/reexports">arrow</a></span>(<span class="dt">length =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/reexports">unit</a></span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>),<span class="dt">type =</span> <span class="st">"closed"</span>),<span class="dt">curvature =</span> <span class="fl">0.2</span>,<span class="dt">color=</span><span class="st">"gray50"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-51" data-line-number="51"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/viridis/topics/scale_viridis">scale_color_viridis</a></span>(<span class="dt">guide=</span><span class="ot">FALSE</span>,<span class="dt">discrete=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggnetwork/topics/theme_blank">theme_blank</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/lims">ylim</a></span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">1.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/lims">xlim</a></span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">1.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_text">geom_text</a></span>(<span class="dt">data=</span>layout,<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y<span class="fl">-0.2</span>,<span class="dt">label =</span> vertex.names), <span class="dt">size =</span> <span class="dv">6</span>,<span class="dt">color=</span><span class="st">"black"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-52" data-line-number="52"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_text">geom_text</a></span>(<span class="dt">data=</span>test2,<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y<span class="fl">+0.2</span>,<span class="dt">label =</span> N), <span class="dt">size =</span> <span class="dv">6</span>,<span class="dt">color=</span><span class="st">"black"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-53" data-line-number="53"><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/transition_states">transition_states</a></span>(time) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/scale_size">scale_size_continuous</a></span>(<span class="dt">guide=</span><span class="ot">FALSE</span>,<span class="dt">range =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>, <span class="dv">30</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb20-54" data-line-number="54"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Time: {closest_state}"</span>)</a>
<a class="sourceLine" id="cb20-55" data-line-number="55"></a>
<a class="sourceLine" id="cb20-56" data-line-number="56"><span class="kw"><a href="https://www.rdocumentation.org/packages/gganimate/topics/animate">animate</a></span>(animated.plot, <span class="dt">nframes=</span>SimulationA<span class="op">$</span>total.time<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">10</span>,<span class="dt">duration=</span><span class="dv">40</span>,<span class="dt">end_pause=</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="discrete_files/figure-html/visualisationMatrix-1.gif"><!-- --></p>
</div>
</div>
<div id="dual-host-pathogen" class="section level1">
<h1 class="hasAnchor">
<a href="#dual-host-pathogen" class="anchor"></a>Dual-host pathogen</h1>
<div id="work-in-progress" class="section level2">
<h2 class="hasAnchor">
<a href="#work-in-progress" class="anchor"></a>WORK IN PROGRESS</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#single-host-pathogen">Single-host pathogen</a><ul class="nav nav-pills nav-stacked">
<li><a href="#structure-of-the-population">Structure of the population</a></li>
      <li><a href="#running-nosoi">Running Nosoi</a></li>
      <li><a href="#nosoi-output">Nosoi output</a></li>
      <li><a href="#visualisation">Visualisation</a></li>
      </ul>
</li>
      <li>
<a href="#dual-host-pathogen">Dual-host pathogen</a><ul class="nav nav-pills nav-stacked">
<li><a href="#work-in-progress">WORK IN PROGRESS</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Lequime, Paul Bastide, Simon Dellicour, Philippe Lemey, Guy Baele.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
