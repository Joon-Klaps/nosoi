<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spread of an Ebola-like virus in continuous space • nosoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Spread of an Ebola-like virus in continuous space">
<meta property="og:description" content="nosoi">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">nosoi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/nosoi.html">
    <span class="fas fa-play-circle"></span>
     
    Getting started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Simulation set up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Visualise &amp; summarise
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/output.html">nosoi output</a>
    </li>
    <li>
      <a href="../../articles/examples/viz.html">Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Pathogen examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/examples/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../../articles/examples/ebola.html">Spread of Ebola-like virus in a continuous space</a>
    </li>
    <li>
      <a href="../../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">
    <span class="fas fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
    <li>
      <a href="../../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../../articles/examples/dengue.html">Spread of a dengue-like virus in a discrete space</a>
    </li>
    <li>
      <a href="../../articles/examples/ebola.html">Spread of an Ebola-like virus in continuous space</a>
    </li>
    <li>
      <a href="../../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence variation</a>
    </li>
    <li>
      <a href="../../articles/examples/viz.html">Visualization tips</a>
    </li>
    <li>
      <a href="../../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../../articles/output.html">Output and summarization</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/slequime/nosoi">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ebola_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spread of an Ebola-like virus in continuous space</h1>
                        <h4 class="author">Sebastian Lequime &amp; Simon Dellicour</h4>
            
            <h4 class="date">2021-08-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slequime/nosoi/blob/master/vignettes/examples/ebola.Rmd"><code>vignettes/examples/ebola.Rmd</code></a></small>
      <div class="hidden name"><code>ebola.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this example, we aim to simulate an Ebola-like epidemic in Western Africa. We will use the distribution of the population in this region as the “environmental factor” to be included in our simulation (origin: <a href="https://www.worldpop.org/">WorldPop</a>).</p>
<p>A compressed version of the raster can be found on the <a href="https://github.com/slequime/nosoi/blob/master/docs/articles/examples/Africa_pop_2015.tif.zip">GitHub repository</a>. The following chunk of code can be used to download it in <code>R</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create tmp file and download WorldPop Africa raster data</span>
<span class="va">tmp_dir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tmp_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>tmpdir <span class="op">=</span> <span class="va">tmp_dir</span>, fileext <span class="op">=</span> <span class="st">".zip"</span><span class="op">)</span>
<span class="va">raster_url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/slequime/nosoi/raw/master/docs/articles/examples/Africa_pop_2015.tif.zip"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="va">raster_url</span>, <span class="va">tmp_file</span><span class="op">)</span>
<span class="va">data_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span><span class="op">(</span><span class="va">tmp_file</span>, exdir <span class="op">=</span> <span class="va">tmp_dir</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">tmp_dir</span>, <span class="va">tmp_file</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We can then plot the map used in this example (here represented on a log scale to show efficiently differences in distribution):</p>
<p><img src="ebola_files/figure-html/importRaster-1.png" width="700"></p>
<p>Ebola will here be considered a single-host pathogen, and some of the pathogen-related parameters can be found in the literature. The others will be empirically fixed to realistic values. As estimated for the 2013 epidemic, the first infected host will start at Gueckedou in Guinea.</p>
</div>
<div id="host-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#host-parameters" class="anchor"></a>Host parameters</h1>
<div id="pexit" class="section level2">
<h2 class="hasAnchor">
<a href="#pexit" class="anchor"></a><code>pExit</code>
</h2>
<p>The probability of exiting (i.e. in our case recovering or dying from the infection) for each host will depend on (1) time since infection and (2) a host parameter called <code>t_incub</code> for “incubation time” that will be sampled, for each host, based on a published article ( <a href="https://www.ncbi.nlm.nih.gov/pubmed/12698919">Casillas et al. 2003 Biol Res Nurs</a> ):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
    <span class="va">t_incub</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
    <span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
        <span class="op">{</span>
            <span class="va">t_incub</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>, mean<span class="op">=</span><span class="fl">6.5</span>, sd<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>
            <span class="va">t_incub</span> <span class="op">=</span> <span class="va">t_incub</span><span class="op">[</span><span class="op">(</span><span class="va">t_incub</span><span class="op">&gt;=</span><span class="fl">2</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">t_incub</span><span class="op">&lt;=</span><span class="fl">21</span><span class="op">)</span><span class="op">]</span>
            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
                <span class="op">{</span>
                    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">x</span><span class="op">)</span>
                        <span class="op">{</span>
                            <span class="va">t_incub</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">t_incub</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">t_incub</span>,<span class="va">x</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
                        <span class="op">}</span>
                <span class="op">}</span>   
        <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>which gives the following distribution for 1,000 hosts:</p>
<p><img src="ebola_files/figure-html/tincubDemo-1.png" width="700"></p>
<p>If “time since infection” (hereafter <code>t</code>) is below the incubation time (<code>t_incub</code>), then the probability to exit is null. If <code>t</code> is greater that <code>t_incub</code> but below a recovery time (<code>t_recovery</code> fixed at 20 days after symptom onset), then the daily probability to exit (by dying) is 2.5%. If <code>t</code> is greater than <code>t_recovery</code>, then the probability to exit (by being cured) is 1.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_Exit_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span> <span class="co"># return(0.1)} # should return a value between 0 and 1 (probability)</span>
  <span class="va">t_recovery</span> <span class="op">=</span> <span class="fl">20</span> <span class="co"># days before recovery</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="op">(</span><span class="va">t_incub</span><span class="op">+</span><span class="va">t_recovery</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0.025</span> <span class="op">}</span> <span class="co"># 50% chance to die before recovery</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="op">(</span><span class="va">t_incub</span><span class="op">+</span><span class="va">t_recovery</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">}</span> 
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="movement" class="section level2">
<h2 class="hasAnchor">
<a href="#movement" class="anchor"></a>Movement</h2>
<p>The daily probability to move <code>pMove</code> for a host is empirically set to 0.01 (1% chance for a host to move each day) before onset of symptoms. We will assume here that every infection will be symptomatic (although this is a crude assumption). Once symptoms are apparent, <code>pMove</code> will be set at 0.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_Move_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span> 
   <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0.01</span> <span class="op">}</span>
   <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0</span><span class="op">}</span>
       <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>The distance traveled is determined by the standard deviation of the Brownian motion (<code>sdMove</code>) used as the movement kernel in <code>nosoi</code>. Keep in mind that this standard deviation is in your coordinate space, so the actual distance traveled by the host may actually vary according to your space. For each host that moves, a standard deviation will be sampled using this function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">sdMove_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>,min<span class="op">=</span><span class="fl">0.5</span>,max<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>This function will lead to the following distribution for 1,000 hosts:</p>
<p><img src="ebola_files/figure-html/sdMove2-1.png" width="700"></p>
</div>
<div id="ncontact" class="section level2">
<h2 class="hasAnchor">
<a href="#ncontact" class="anchor"></a><code>nContact</code>
</h2>
<p>The daily number of infection contacts <code>nContact</code> per infected host will be fixed at 5, but will depend on the number of hosts (i.e. population) around. It will thus depend on the “environmental value” <code>current.env.value</code> provided by the raster. To avoid reaching unrealistic values (i.e. much more infected hosts than hosts leaving there), a cap provided by <code>host.count</code> (number of hosts currently in the raster cell) will be used:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_contact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">current.env.value</span>, <span class="va">host.count</span><span class="op">)</span><span class="op">{</span> 
  <span class="kw">if</span><span class="op">(</span><span class="va">host.count</span> <span class="op">&lt;</span> <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span><span class="fl">5</span><span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">host.count</span> <span class="op">&gt;=</span> <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span><span class="fl">0</span><span class="op">}</span>
   <span class="op">}</span></code></pre></div>
</div>
<div id="ptrans" class="section level2">
<h2 class="hasAnchor">
<a href="#ptrans" class="anchor"></a><code>pTrans</code>
</h2>
<p>Once contact has been made, the probability of transmission itself will depend of the incubation time <code>t_incub</code> (see above). The probability to transmit, if <code>t_incub</code> is reached, will be 0.025 (loosely based on <a href="https://www.ncbi.nlm.nih.gov/pubmed/28396472">Skrip et al. 2017 Philos Trans R Soc Lond B Biol Sci</a> ):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">proba</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0.025</span> <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div id="running-nosoi" class="section level1">
<h1 class="hasAnchor">
<a href="#running-nosoi" class="anchor"></a>Running <code>nosoi</code>
</h1>
<p>Now that every parameter and function has been chosen and set up, we can run the simulation. Most of the replicates will fail to yield a “successful” epidemic (i.e. with a lot of infected individuals) due to the high stochasticity of the model. However some will work; the following random number seed assures that a “successful” simulation will occur.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slequime/nosoi">nosoi</a></span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: data.table</code></pre>
<pre><code>## 
## Attaching package: 'data.table'</code></pre>
<pre><code>## The following object is masked from 'package:raster':
## 
##     shift</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Raster (to uncomment in your case):</span>

<span class="co"># e_WestAfrica = extent(-18, -3, 3, 15) # WorldPop Africa raster:</span>
<span class="co"># population = crop(raster("~/path/to/the/raster.tif"), e_WestAfrica)</span>

<span class="co">#Starting parameter:</span>
<span class="va">start.pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10.132</span>, <span class="fl">8.561</span><span class="op">)</span> <span class="co"># Guéckédou in Guinea</span>

<span class="co">#pExit:</span>
<span class="va">p_Exit_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span>
  <span class="va">t_recovery</span> <span class="op">=</span> <span class="fl">20</span> <span class="co"># days before recovery</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="op">(</span><span class="va">t_incub</span><span class="op">+</span><span class="va">t_recovery</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0.025</span> <span class="op">}</span> <span class="co"># 50% chance to dye before recovery</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="op">(</span><span class="va">t_incub</span><span class="op">+</span><span class="va">t_recovery</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">}</span> 
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">#pMove:</span>
<span class="va">p_Move_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span> 
   <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0.01</span> <span class="op">}</span>
   <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0</span><span class="op">}</span>
       <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">}</span>

<span class="co">#sdMove:</span>
 <span class="va">sdMove_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>,min<span class="op">=</span><span class="fl">0.5</span>,max<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">}</span>
 
<span class="co">#nContact:</span>
<span class="va">n_contact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">current.env.value</span>, <span class="va">host.count</span><span class="op">)</span><span class="op">{</span> 
  <span class="kw">if</span><span class="op">(</span><span class="va">host.count</span> <span class="op">&lt;</span> <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">}</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">host.count</span> <span class="op">&gt;=</span> <span class="va">current.env.value</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">}</span>
<span class="op">}</span>

<span class="co">#pTrans:</span>
<span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
    <span class="va">t_incub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
    <span class="kw">while</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>
        <span class="op">{</span>
            <span class="va">t_incub</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>, mean<span class="op">=</span><span class="fl">6.5</span>, sd<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>
            <span class="va">t_incub</span> <span class="op">=</span> <span class="va">t_incub</span><span class="op">[</span><span class="op">(</span><span class="va">t_incub</span><span class="op">&gt;=</span><span class="fl">2</span><span class="op">)</span><span class="op">&amp;</span><span class="op">(</span><span class="va">t_incub</span><span class="op">&lt;=</span><span class="fl">21</span><span class="op">)</span><span class="op">]</span>
            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
                <span class="op">{</span>
                    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">x</span><span class="op">)</span>
                        <span class="op">{</span>
                            <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span>
                            <span class="va">t_incub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">t_incub</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">t_incub</span>,<span class="va">x</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
                        <span class="op">}</span>
                <span class="op">}</span>   
        <span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">t_incub</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">proba</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0</span> <span class="op">}</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t_incub</span><span class="op">)</span> <span class="op">{</span> <span class="va">p</span> <span class="op">=</span> <span class="fl">0.025</span> <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">#Starting the simulation ------------------------------------</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">505060</span><span class="op">)</span>
<span class="va">test.nosoiA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>
    type <span class="op">=</span> <span class="st">"single"</span>, popStructure <span class="op">=</span> <span class="st">"continuous"</span>,
    length <span class="op">=</span> <span class="fl">365</span>, 
    max.infected <span class="op">=</span> <span class="fl">10000</span>, 
    init.individuals <span class="op">=</span> <span class="fl">1</span>, 
    init.structure <span class="op">=</span> <span class="va">start.pos</span>,
    structure.raster <span class="op">=</span> <span class="va">population</span>,
    
    <span class="co">#pExit:</span>
    diff.pExit <span class="op">=</span> <span class="cn">FALSE</span>,
    timeDep.pExit <span class="op">=</span> <span class="cn">FALSE</span>, 
    pExit <span class="op">=</span> <span class="va">p_Exit_fct</span>, 
    param.pExit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>t_incub <span class="op">=</span> <span class="va">t_incub_fct</span><span class="op">)</span>,
    
    <span class="co">#pMove:</span>
    diff.pMove <span class="op">=</span> <span class="cn">FALSE</span>, 
    timeDep.pMove <span class="op">=</span> <span class="cn">FALSE</span>,
    pMove <span class="op">=</span> <span class="va">p_Move_fct</span>,
    param.pMove <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>t_incub <span class="op">=</span> <span class="va">t_incub_fct</span><span class="op">)</span>,
    
    <span class="co">#sdMove:</span>
    diff.sdMove <span class="op">=</span> <span class="cn">FALSE</span>, 
    timeDep.sdMove <span class="op">=</span> <span class="cn">FALSE</span>, 
    sdMove <span class="op">=</span> <span class="va">sdMove_fct</span>, 
    param.sdMove <span class="op">=</span> <span class="cn">NA</span>, 
    attracted.by.raster <span class="op">=</span> <span class="cn">FALSE</span>,
    
    <span class="co">#nContact:</span>
    diff.nContact <span class="op">=</span> <span class="cn">TRUE</span>, 
    timeDep.nContact <span class="op">=</span> <span class="cn">FALSE</span>, 
    hostCount.nContact <span class="op">=</span> <span class="cn">TRUE</span>,
    nContact <span class="op">=</span> <span class="va">n_contact</span>,
    param.nContact <span class="op">=</span> <span class="cn">NA</span>,
    
    <span class="co">#pTrans:</span>
    diff.pTrans <span class="op">=</span> <span class="cn">FALSE</span>, 
    timeDep.pTrans <span class="op">=</span> <span class="cn">FALSE</span>, 
    pTrans <span class="op">=</span> <span class="va">proba</span>, 
    param.pTrans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>t_incub <span class="op">=</span> <span class="va">t_incub_fct</span><span class="op">)</span>,

  <span class="co">#Closing parameters:</span>
    prefix.host <span class="op">=</span> <span class="st">"H"</span>, 
    print.progress <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Starting the simulation
## Initializing ...</code></pre>
<pre><code>##  running ...</code></pre>
<pre><code>## done. 
## The simulation has run for 365 units of time and a total of 3603 hosts have been infected.</code></pre>
<p>The simulation has run for 365 days and has infected 3603 individual hosts.</p>
</div>
<div id="analyzing-the-results" class="section level1">
<h1 class="hasAnchor">
<a href="#analyzing-the-results" class="anchor"></a>Analyzing the results</h1>
<div id="visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h2>
<p>Our first step will be to visualize this simulated epidemic on the map. We can use the following code to produce an animation (in time) of the epidemic:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getTableState.html">getTableState</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/">ggspatial</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gganimate.com">gganimate</a></span><span class="op">)</span>

<span class="co">#The following script gives the position of every host at every time point:</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">test.data</span><span class="op">$</span><span class="va">time.from</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">test.data</span>, <span class="op">(</span><span class="va">time.from</span> <span class="op">&lt;=</span> <span class="va">i</span><span class="op">)</span><span class="op">&amp;</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">time.to</span> <span class="op">&gt;</span> <span class="va">i</span><span class="op">)</span><span class="op">|</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">time.to</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hosts.ID"</span>,<span class="st">"state.x"</span>,<span class="st">"state.y"</span>,<span class="st">"current.env.value"</span><span class="op">)</span><span class="op">]</span>
    <span class="va">temp</span><span class="op">$</span><span class="va">time</span> <span class="op">=</span> <span class="va">i</span>
    <span class="va">results</span><span class="op">=</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">#This is for the animated plot:</span>

<span class="va">animated.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_fill_viridis</span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log1p"</span>,option<span class="op">=</span><span class="st">"A"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"NA"</span>, name<span class="op">=</span><span class="st">"Environmental\nvalue (number of\ninhabitants)"</span>,
                     position<span class="op">=</span><span class="st">"bottom"</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">6000</span>,<span class="fl">60000</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">6000</span>,<span class="fl">60000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">results</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">state.x</span>,<span class="va">state.y</span><span class="op">)</span> ,show.legend<span class="op">=</span><span class="cn">F</span>, color<span class="op">=</span><span class="st">"firebrick3"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://gganimate.com/reference/transition_states.html">transition_states</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        panel.ontop <span class="op">=</span> <span class="cn">FALSE</span>,
        panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.25</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, colour<span class="op">=</span><span class="st">"grey70"</span><span class="op">)</span>,
        axis.ticks<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        plot.caption<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Time: {closest_state}"</span><span class="op">)</span>

<span class="fu"><a href="https://gganimate.com/reference/animate.html">animate</a></span><span class="op">(</span><span class="va">animated.plot</span>, nframes<span class="op">=</span><span class="va">test.nosoiA</span><span class="op">$</span><span class="va">total.time</span><span class="op">*</span><span class="fl">2</span><span class="op">+</span><span class="fl">10</span>,duration<span class="op">=</span><span class="fl">40</span>,end_pause<span class="op">=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="ebola-like.gif"></p>
<p>In this animation, green dots represent the infected hosts, each dot being an individual host (beware, dots can overlap). The transparency for each dot allows to visualize superposition of dots, in a certain measure, and explains why some dots appear darker (no overlap) than others (overlap). Time is in days.</p>
<blockquote>
<p>Beware, the gif file displayed here has been produced with a lower resolution raster to avoid a big file size. If you try to prepare this gif without reducing the raster resolution, it might take several hours (or days!) to finish.</p>
</blockquote>
</div>
<div id="epidemiological-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#epidemiological-analysis" class="anchor"></a>Epidemiological analysis</h2>
<p>As interesting as the visualization might be, we can also explore the epidemic parameters, for example the “real” <span class="math inline">\(R_0\)</span>, defined as the average number of cases one case generates, often estimated in epidemiological studies. To this end, we can use the following code:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">R0.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getR0.html">getR0</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span></code></pre></div>
<p>The mean value for <span class="math inline">\(R_0\)</span> is 1.12, which is coherent with epidemiological estimates for Ebola virus. Its distribution is also coherent with most hosts not transmitting:</p>
<p><img src="ebola_files/figure-html/generalEpi3-1.png" width="700"></p>
<p>The two following figures also give the epidemiological dynamics of the simulation:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dynamic.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getDynamic.html">getDynamic</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span>
<span class="va">cumulative.sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getCumulative.html">getCumulative</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dynamic.sim</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Time (t)"</span>,y<span class="op">=</span><span class="st">"Number of active infected hosts"</span><span class="op">)</span></code></pre></div>
<p><img src="ebola_files/figure-html/cumulativeDynamics-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">cumulative.sim</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">t</span>, y<span class="op">=</span><span class="va">Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Time (t)"</span>,y<span class="op">=</span><span class="st">"Cumulative count of infected hosts"</span><span class="op">)</span></code></pre></div>
<p><img src="ebola_files/figure-html/cumulativeDynamics-2.png" width="700"></p>
</div>
<div id="transmission-chain" class="section level2">
<h2 class="hasAnchor">
<a href="#transmission-chain" class="anchor"></a>Transmission chain</h2>
<p>Since <code>nosoi</code> relies on the simulation of a transmission chain, we can also visualize the transmission in geographic space. To do this, we will first generate the transmission tree as a phylogenetic tree-like object by using the <code>getTransmissionTree</code> function implemented in <code>nosoi</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test.nosoiA.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getTransmissionTree.html">getTransmissionTree</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span></code></pre></div>
<p>This function gives you a <code>treedata</code> object that can be visualized as a phylogenetic tree with the package :</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">test.nosoiA.tree</span>, color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_nodepoint.html">geom_nodepoint</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tippoint.html">geom_tippoint</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># geom_tiplab(aes(label=host)) + </span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/theme_tree2.html">theme_tree2</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (t)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>, 
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ebola_files/figure-html/treeC-1.png" width="700"></p>
<p>Of course this does not give us much information about the spatial distribution of this transmission tree. We can use data contained into this <code>treedata</code> object to plot our transmission tree on our environmental raster:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extracting node data from the tree (including long/lat coordinates):</span>
<span class="va">tree.node</span> <span class="op">&lt;-</span> <span class="fu">tidytree</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">test.nosoiA.tree</span><span class="op">)</span>

<span class="co"># Joining table to get coordinates of starting and ending nodes:</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">tree.links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tree.node</span>, <span class="va">tree.node</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"parent"</span> <span class="op">=</span> <span class="st">"node"</span><span class="op">)</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".to"</span>, <span class="st">".from"</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Plotting everything:</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu">scale_fill_viridis</span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log1p"</span>,option<span class="op">=</span><span class="st">"A"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"NA"</span>, 
                     name<span class="op">=</span><span class="st">"Environmental\nvalue (number of\ninhabitants)"</span>, position<span class="op">=</span><span class="st">"bottom"</span>, 
                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">6000</span>,<span class="fl">60000</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">6000</span>,<span class="fl">60000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>option<span class="op">=</span><span class="st">"D"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"white"</span>, name<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, panel.ontop <span class="op">=</span> <span class="cn">FALSE</span>,
        panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.25</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, colour <span class="op">=</span><span class="st">"grey70"</span><span class="op">)</span>,
        axis.ticks<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.caption<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tree.links</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">state.x.from</span>, y <span class="op">=</span> <span class="va">state.y.from</span>, xend <span class="op">=</span> <span class="va">state.x.to</span>, yend <span class="op">=</span> <span class="va">state.y.to</span><span class="op">)</span>,
               color<span class="op">=</span><span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tree.node</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">state.x</span>, y<span class="op">=</span><span class="va">state.y</span>,color<span class="op">=</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ebola_files/figure-html/transmissionTree-Full2-1.png" width="700"></p>
<p>The full transmission chain is a bit messy, because of the number of infected individuals. We can also subsample it randomly. We will here select 250 individuals sampled at the time of their exit (either death or recovery):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Extracts data from the nosoiSim object:</span>
<span class="va">test.table.hosts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getTableHosts.html">getTableHosts</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span>
<span class="va">test.nosoiA.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/getTransmissionTree.html">getTransmissionTree</a></span><span class="op">(</span><span class="va">test.nosoiA</span><span class="op">)</span>

<span class="co">#Sampling the names of individuals to be sampled:</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">5905950</span><span class="op">)</span>
<span class="va">sampled.hosts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/subset.html">subset</a></span><span class="op">(</span><span class="va">test.table.hosts</span>, <span class="va">active</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">hosts.ID</span>, <span class="fl">250</span><span class="op">)</span>

<span class="co">#Subsampling:</span>
<span class="va">test.nosoiA.tree.sampled.exiting</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sampleTransmissionTreeFromExiting.html">sampleTransmissionTreeFromExiting</a></span><span class="op">(</span><span class="va">test.nosoiA.tree</span>, <span class="va">sampled.hosts</span><span class="op">)</span></code></pre></div>
<p>This new tree can be plotted as before:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/treedata-book/">ggtree</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/ggtree.html">ggtree</a></span><span class="op">(</span><span class="va">test.nosoiA.tree.sampled.exiting</span>, color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_nodepoint.html">geom_nodepoint</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/geom_tippoint.html">geom_tippoint</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray30"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># geom_tiplab(aes(label=host)) + </span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggtree/man/theme_tree2.html">theme_tree2</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (t)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>, 
        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ebola_files/figure-html/treeC2-1.png" width="700"></p>
<p>We can also draw it in geographic space:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extracting node data from the tree (including long/lat coordinates):</span>
<span class="va">tree.node</span> <span class="op">&lt;-</span> <span class="fu">tidytree</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">test.nosoiA.tree.sampled.exiting</span><span class="op">)</span>

<span class="co"># Joining table to get coordinates of starting and ending nodes:</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="va">tree.links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tree.node</span>, <span class="va">tree.node</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"parent"</span> <span class="op">=</span> <span class="st">"node"</span><span class="op">)</span>, suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".to"</span>, <span class="st">".from"</span><span class="op">)</span><span class="op">)</span>

<span class="co">#plotting everything</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/layer_spatial.html">layer_spatial</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>  
  <span class="fu">scale_fill_viridis</span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log1p"</span>,option<span class="op">=</span><span class="st">"A"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"NA"</span>, 
                     name<span class="op">=</span><span class="st">"Environmental\nvalue (number of\ninhabitants)"</span>, position<span class="op">=</span><span class="st">"bottom"</span>, 
                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">6000</span>,<span class="fl">60000</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">60</span>,<span class="fl">600</span>,<span class="fl">6000</span>,<span class="fl">60000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_color_viridis</span><span class="op">(</span>option<span class="op">=</span><span class="st">"D"</span>,limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="cn">NA</span><span class="op">)</span>,na.value<span class="op">=</span><span class="st">"white"</span>, name<span class="op">=</span><span class="st">"time"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, panel.ontop <span class="op">=</span> <span class="cn">FALSE</span>,
        panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.25</span>, linetype<span class="op">=</span><span class="st">"dashed"</span>, colour <span class="op">=</span><span class="st">"grey70"</span><span class="op">)</span>,
        axis.ticks<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, plot.caption<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tree.links</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">state.x.from</span>, y <span class="op">=</span> <span class="va">state.y.from</span>, xend <span class="op">=</span> <span class="va">state.x.to</span>, yend <span class="op">=</span> <span class="va">state.y.to</span><span class="op">)</span>,
               color<span class="op">=</span><span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tree.node</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">state.x</span>, y<span class="op">=</span><span class="va">state.y</span>,color<span class="op">=</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ebola_files/figure-html/transmissionTree-Full3-1.png" width="700"></p>
</div>
<div id="other-use" class="section level2">
<h2 class="hasAnchor">
<a href="#other-use" class="anchor"></a>Other use</h2>
<p>External software can be used to perform a more detailed exploration of the dynamics of this epidemic and transmission chain. The <code>write.beast</code> function of the <code>treeio</code> package allows for an easy export of the transmission chain as a phylogenetic-like tree, in a similar format as <a href="https://beast.community/">BEAST</a> trees.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">treeio</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/treeio/reference/write.beast.html">write.beast</a></span><span class="op">(</span><span class="va">test.nosoiA.tree</span>, file <span class="op">=</span> <span class="st">"test.tre"</span>, translate <span class="op">=</span> <span class="cn">TRUE</span>, tree.name <span class="op">=</span> <span class="st">"UNTITLED"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Lequime, Paul Bastide, Simon Dellicour, Philippe Lemey, Guy Baele.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
