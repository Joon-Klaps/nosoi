<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spread of a pathogen in a homogeneous population • nosoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spread of a pathogen in a homogeneous population">
<meta property="og:description" content="nosoi">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nosoi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nosoi.html">
    <span class="fas fa-play-circle"></span>
     
    Getting started
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Simulation set up
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Visualise &amp; summarise
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/output.html">nosoi output</a>
    </li>
    <li>
      <a href="../articles/examples/viz.html">Visualization</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Pathogen examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples/dengue.html">Spread of dengue virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/examples/ebola.html">Spread of Ebola-like virus in a continuous space</a>
    </li>
    <li>
      <a href="../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/continuous.html">Spread of a pathogen in a continuous space</a>
    </li>
    <li>
      <a href="../articles/discrete.html">Spread of a pathogen in a discrete structured population</a>
    </li>
    <li>
      <a href="../articles/examples/dengue.html">Spread of a dengue-like virus in a discrete space</a>
    </li>
    <li>
      <a href="../articles/examples/ebola.html">Spread of an Ebola-like virus in continuous space</a>
    </li>
    <li>
      <a href="../articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence variation</a>
    </li>
    <li>
      <a href="../articles/examples/viz.html">Visualization tips</a>
    </li>
    <li>
      <a href="../articles/none.html">Spread of a pathogen in a homogeneous population</a>
    </li>
    <li>
      <a href="../articles/output.html">Output and summarization</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/slequime/nosoi">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="none_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spread of a pathogen in a homogeneous population</h1>
                        <h4 class="author">Sebastian Lequime</h4>
            
            <h4 class="date">2021-08-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slequime/nosoi/blob/master/vignettes/none.Rmd"><code>vignettes/none.Rmd</code></a></small>
      <div class="hidden name"><code>none.Rmd</code></div>

    </div>

    
    
<p><code>nosoi</code> can accommodate a wide range of epidemiological transmission scenarios. <!-- Doing so requires providing the proper parameter values. --> It hence relies on many parameters, that need to be set properly for the right scenario to be simulated. This tutorial aims to illustrate how to set up a <code>nosoi</code> simulation for a “simple” case: a pathogen being transmitted within a population without structure. We will present two cases, first for a single-host, and then a dual-host pathogen.</p>
<div id="setting-up-the-simulation" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-up-the-simulation" class="anchor"></a>Setting up the simulation</h1>
<p>The wrapper function <code>nosoiSim</code> takes all the arguments that will be passed down to the simulator, in the case of this tutorial <code>singleNone</code> (for “single host, no structure”). We thus start by providing the options <code>type="single"</code> and <code>popStructure="none"</code> to set up the analysis:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SimulationSingle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"single"</span>, popStructure<span class="op">=</span><span class="st">"none"</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
<p>This simulation type requires several arguments or options in order to run, namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected</code></li>
<li><code>init.individuals</code></li>
<li>
<code>pExit</code> with <code>param.pExit</code> and <code>timeDep.pExit</code>
</li>
<li>
<code>nContact</code> with <code>param.nContact</code> and <code>timeDep.nContact</code>
</li>
<li>
<code>pTrans</code> with <code>param.pTrans</code> and <code>timeDep.pTrans</code>
</li>
<li><code>prefix.host</code></li>
<li><code>progress.bar</code></li>
<li><code>print.step</code></li>
</ul>
<p>All the <code>param.*</code> elements provide individual-level parameters to be taken into account, while the <code>timeDep.*</code> elements inform the simulator if the “absolute” simulation time should be taken into account.</p>
<div id="general-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#general-parameters" class="anchor"></a>General parameters</h2>
<p><code>length.sim</code>, <code>max.infected</code> and <code>init.individuals</code> are general parameters that define the simulation:</p>
<ul>
<li>
<code>length.sim</code> is the maximum number of time units (e.g. days, months, years, or another time unit of choice) during which the simulation will be run.</li>
<li>
<code>max.infected</code> is the maximum number of individuals that can be infected during the simulation.</li>
<li>
<code>init.individuals</code> defines the number of individuals (an integer above 1) that will start a transmission chain (there will be as many transmission chains as initial individuals that “seed” the epidemic process).</li>
</ul>
<p>Here, we will run a simulation starting with 1 individual, for a maximum of 1,000 infected individuals and a maximum time of 300 days.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SimulationSingle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"single"</span>, popStructure<span class="op">=</span><span class="st">"none"</span>,
                             length.sim<span class="op">=</span><span class="fl">300</span>, max.infected<span class="op">=</span><span class="fl">1000</span>, init.individuals<span class="op">=</span><span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="core-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#core-functions" class="anchor"></a>Core functions</h2>
<p>The core functions <code>pExit</code>, <code>nContact</code> and <code>pTrans</code> each follow the <a href="nosoi.html#setting-up-the-core-functions">same principles to be set up</a>.</p>
<p>To accommodate for different scenarios, they can be constant, time-dependent (using the relative time since infection <code>t</code> for each individual or the “absolute” time <code>pres.time</code> of the simulation) or even individually parameterized, to include some stochasticity at the individual-host level.</p>
<p>In any case, the provided function, like all other core functions in <code>nosoi</code>, has to be expressed as a function of time <code>t</code>, even if time is not used to compute the probability.</p>
<p>In case the function uses individual-based parameters, they must be specified in a list of functions (called <code>param.pExit</code>, <code>param.nContact</code> or <code>param.pTrans</code>) (see <a href="nosoi.html#parameters">Get started</a>). If no individual-based parameters are used, then these lists are set to <code>NA</code>.</p>
<blockquote>
<p>Keep in mind that <code>pExit</code> and <code>pTrans</code> have to return a probability (i.e. a number between 0 and 1) while <code>nContact</code> should return a natural number (positive integer or zero).</p>
</blockquote>
<p>Several parameters, such as the time since infection, the “absolute” time of the simulation and individual-based parameters can be combined within the same function.</p>
<blockquote>
<p>In any case, time since infection and “absolute” time should ALWAYS be designated by <code>t</code> and <code>prestime</code> respectively. They also have to be used in the order: (1) <code>t</code>; (2) <code>prestime</code> and (3) individual-based parameters. This is necessary for the function to be properly parsed by <code>nosoi</code>.</p>
</blockquote>
<div id="pexit-param-pexit-and-timedep-pexit" class="section level3">
<h3 class="hasAnchor">
<a href="#pexit-param-pexit-and-timedep-pexit" class="anchor"></a><code>pExit</code>, <code>param.pExit</code> and <code>timeDep.pExit</code>
</h3>
<ul>
<li>
<code>pExit</code> is the first required fundamental parameter and provides a daily probability for a host to leave the simulation (either cured, died, etc.).</li>
<li>
<code>param.pExit</code> is the list of functions needed to individually parameterize <code>pExit</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function in the list has to match the name of the parameter it is sampling for <code>pExit</code>.</li>
<li>
<code>timeDep.pExit</code> allows for <code>pExit</code> to be dependent on the “absolute” time of the simulation, to account - for example - for seasonality or other external time-related covariates. By default, <code>timeDep.pExit</code> is set to <code>FALSE</code>.</li>
</ul>
</div>
<div id="ncontact-param-ncontact-and-timedep-ncontact" class="section level3">
<h3 class="hasAnchor">
<a href="#ncontact-param-ncontact-and-timedep-ncontact" class="anchor"></a><code>nContact</code>, <code>param.nContact</code> and <code>timeDep.nContact</code>
</h3>
<ul>
<li>
<code>nContact</code> represents the number (expressed as a positive integer) of potentially infectious contacts an infected hosts can encounter per unit of time. At each time point, a number of contacts will be determined for each active host in the simulation. The number of contacts (i.e. the output of your function) has to be an integer and can be set to zero.</li>
<li>
<code>param.nContact</code> is the list of functions needed to individually parameterize <code>nContact</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function in the list has to match the name of the parameter it is sampling for <code>nContact</code>.</li>
<li>
<code>timeDep.nContact</code> allows for <code>nContact</code> to be dependent on the “absolute” time of the simulation, to account - for example - for seasonality or other external time-related covariates. By default, <code>timeDep.nContact</code> is set to <code>FALSE</code>.</li>
</ul>
</div>
<div id="ptrans-param-ptrans-and-timedep-ptrans" class="section level3">
<h3 class="hasAnchor">
<a href="#ptrans-param-ptrans-and-timedep-ptrans" class="anchor"></a><code>pTrans</code>, <code>param.pTrans</code> and <code>timeDep.pTrans</code>
</h3>
<ul>
<li>
<code>pTrans</code> is the heart of the transmission process and represents the probability of transmission over time (when a contact occurs).</li>
<li>
<code>param.pTrans</code> is the list of functions needed to individually parameterize <code>pTrans</code> (see <a href="nosoi.html#parameters">Get started</a>). The name of each function in the list has to match the name of the parameter it is sampling for <code>pTrans</code>.</li>
<li>
<code>timeDep.pTrans</code> allows for <code>pTrans</code> to be dependent on the “absolute” time of the simulation, to account - for example - for seasonality or other external time-related covariates. By default, <code>timeDep.pTrans</code> is set to <code>FALSE</code>.</li>
</ul>
</div>
</div>
<div id="miscellaneous" class="section level2">
<h2 class="hasAnchor">
<a href="#miscellaneous" class="anchor"></a>Miscellaneous</h2>
<p><code>prefix.host</code> allows you to define the first character(s) for the hosts’ unique ID. It will be followed by a hyphen and a unique number. By default, <code>prefix.host</code> is “H” for “Host”.</p>
<p><code>print.progress</code> allows you to have some information printed on the screen about the simulation as it is running. It will print something every <code>print.step</code>. By default, <code>print.progress</code> is activated with a <code>print.step = 10</code> (you can change this frequency), but you may want to deactivate it by setting <code>print.progress=FALSE</code>.</p>
</div>
<div id="dual-host" class="section level2">
<h2 class="hasAnchor">
<a href="#dual-host" class="anchor"></a>Dual host</h2>
<p>In the case of a dual host simulation, several parameters of the <code>nosoiSim</code> will have to be specified for each host type, designated by <code>A</code> and <code>B</code>. The wrapper function <code>nosoiSim</code> will then take all the arguments that will be passed down to the simulator, in the case of this tutorial <code>dualNone</code> (for “dual host, no structure”). We thus start by providing the options <code>type="dual"</code> and <code>popStructure="none"</code> to set up the analysis:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SimulationDual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"dual"</span>, popStructure<span class="op">=</span><span class="st">"none"</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
<p>As with <code>singleNone</code>, this function takes several arguments or options to be able to run, namely:</p>
<ul>
<li><code>length.sim</code></li>
<li><code>max.infected.A</code></li>
<li><code>max.infected.B</code></li>
<li><code>init.individuals.A</code></li>
<li><code>init.individuals.B</code></li>
<li>
<code>pExit.A</code> with <code>param.pExit.A</code> and <code>timeDep.pExit.A</code>
</li>
<li>
<code>nContact.A</code> with <code>param.nContact.A</code> and <code>timeDep.nContact.A</code>
</li>
<li>
<code>pTrans.A</code> with <code>param.pTrans.A</code> and <code>timeDep.pTrans.A</code>
</li>
<li><code>prefix.host.A</code></li>
<li>
<code>pExit.B</code> with <code>param.pExit.B</code> and <code>timeDep.pExit.B</code>
</li>
<li>
<code>nContact.B</code> with <code>param.nContact.B</code> and <code>timeDep.nContact.B</code>
</li>
<li>
<code>pTrans.B</code> with <code>param.pTrans.B</code> and <code>timeDep.pTrans.B</code>
</li>
<li><code>prefix.host.B</code></li>
<li><code>print.progress</code></li>
<li><code>print.step</code></li>
</ul>
<p>As you can see, host-type dependent parameters are now designated by the suffix <code>.A</code> or <code>.B</code>.</p>
<p>Both <code>max.infected.A</code> and <code>max.infected.B</code> have to be provided to set an upper limit on the simulation size. To initiate the simulation, you have to provide at least one starting host, either <code>A</code> or <code>B</code> in <code>init.individuals.A</code> or <code>init.individuals.B</code> respectively. If you want to start the simulation with one host only, then the <code>init.individuals</code> of the other can be set to 0.</p>
</div>
</div>
<div id="running-nosoi" class="section level1">
<h1 class="hasAnchor">
<a href="#running-nosoi" class="anchor"></a>Running <code>nosoi</code>
</h1>
<div id="single-host" class="section level2">
<h2 class="hasAnchor">
<a href="#single-host" class="anchor"></a>Single host</h2>
<p>We present here a very simple simulation for a single host pathogen.</p>
<div id="pexit" class="section level3">
<h3 class="hasAnchor">
<a href="#pexit" class="anchor"></a>pExit</h3>
<p>For <code>pExit</code>, we choose a constant value, namely 0.08, i.e. an infected host has 8% chance to leave the simulation at each unit of time:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_Exit_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">0.08</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>Remember that <code>pExit</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>pExit</code> is constant here, there is no use for the “absolute” time of the simulation nor for the individual-based parameters. So <code>param.pExit=NA</code>, and <code>timeDep.pExit=FALSE</code>.</p>
</div>
<div id="ncontact" class="section level3">
<h3 class="hasAnchor">
<a href="#ncontact" class="anchor"></a>nContact</h3>
<p>For <code>nContact</code>, we choose a constant function that will draw a value from a normal distribution with <em>mean</em> = 0.5 and <em>sd</em> = 1, round it, and take its absolute value:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_contact_fct</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>The distribution of <code>nContact</code> looks as follows:</p>
<pre><code>#&gt; 
#&gt; Attaching package: 'dplyr'
#&gt; The following objects are masked from 'package:stats':
#&gt; 
#&gt;     filter, lag
#&gt; The following objects are masked from 'package:base':
#&gt; 
#&gt;     intersect, setdiff, setequal, union</code></pre>
<p><img src="none_files/figure-html/nContact2-1.png" width="700"></p>
<p>At each time step and for each infected host, <code>nContact</code> will be drawn anew. Remember that <code>nContact</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>nContact</code> is constant here, there is no use for the “absolute” time of the simulation nor for the individual-based parameters. So <code>param.nContact=NA</code>, and <code>timeDep.nContact=FALSE</code>.</p>
</div>
<div id="ptrans" class="section level3">
<h3 class="hasAnchor">
<a href="#ptrans" class="anchor"></a>pTrans</h3>
<p>We choose <code>pTrans</code> in the form of a threshold function: before a certain amount of time since initial infection, the host does not transmit (incubation time, which we call <code>t_incub</code>), and after that time it will transmit with a certain (constant) probability (which we call <code>p_max</code>). This function is dependent on the time since the host’s infection <code>t</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_Trans_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">p_max</span>, <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0</span><span class="op">}</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="va">p_max</span><span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Because each host is different (slightly different biotic and abiotic factors), you can expect each host to exhibit differences in the dynamics of infection, and hence the probability of transmission over time. Thus, <code>t_incub</code> and <code>p_max</code> will be sampled for each host individually according to a certain distribution. <code>t_incub</code> will be sampled from a normal distribution of <span class="math inline">\(mean\)</span> = 7 and <span class="math inline">\(sd\)</span> = 1, while <code>p_max</code> will be sampled from a beta distribution with shape parameters <span class="math inline">\(\alpha\)</span> = 5 and <span class="math inline">\(\beta\)</span> = 2:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">7</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>
<span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>Note that here <code>t_incub</code> and <code>p_max</code> are functions of <code>x</code> and not <code>t</code> (they are not core functions but individual-based parameters), and <code>x</code> enters the function as the number of draws to make.</p>
<p>Taken together, the profile for <code>pTrans</code> for a subset of 200 individuals in the population will look as follows:</p>
<p><img src="none_files/figure-html/pTrans3-1.png" width="700"></p>
<p><code>pTrans</code> is not dependent on the “absolute” time of the simulation, so <code>timeDep.pTrans=FALSE</code>. However, since we make use of individual-based parameters, we have to provide a <code>param.pTrans</code> as a list of functions. The name of each element within this list should have the same name that the core function (here <code>pTrans</code>) uses as argument, e.g.:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">7</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>
<span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span>

<span class="va">param_pTrans</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>, t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span></code></pre></div>
</div>
<div id="running" class="section level3">
<h3 class="hasAnchor">
<a href="#running" class="anchor"></a>Running</h3>
<p>Once <code>nosoiSim</code> is set up, you can run the simulation (here the “seed” ensures that you will obtain the same results as in this tutorial):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slequime/nosoi">nosoi</a></span><span class="op">)</span>  
<span class="co">#&gt; Loading required package: data.table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'data.table'</span>
<span class="co">#&gt; The following objects are masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     between, first, last</span>

<span class="co">#pExit</span>
<span class="va">p_Exit_fct</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">0.08</span><span class="op">)</span><span class="op">}</span>

<span class="co">#nContact</span>
<span class="va">n_contact_fct</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>

<span class="co">#pTrans</span>
<span class="va">p_Trans_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">p_max</span>,<span class="va">t_incub</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0</span><span class="op">}</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="va">p_max</span><span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span>
 
<span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">7</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>
<span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span>

<span class="va">param_pTrans</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span>

<span class="co"># Starting the simulation ------------------------------------</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">805</span><span class="op">)</span>
<span class="va">SimulationSingle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"single"</span>, popStructure<span class="op">=</span><span class="st">"none"</span>,
                             length.sim<span class="op">=</span><span class="fl">100</span>, max.infected<span class="op">=</span><span class="fl">100</span>, init.individuals<span class="op">=</span><span class="fl">1</span>, 
                             nContact<span class="op">=</span><span class="va">n_contact_fct</span>,
                             param.nContact<span class="op">=</span><span class="cn">NA</span>,
                             timeDep.nContact<span class="op">=</span><span class="cn">FALSE</span>,
                             pExit <span class="op">=</span> <span class="va">p_Exit_fct</span>,
                             param.pExit<span class="op">=</span><span class="cn">NA</span>,
                             timeDep.pExit<span class="op">=</span><span class="cn">FALSE</span>,
                             pTrans <span class="op">=</span> <span class="va">p_Trans_fct</span>,
                             param.pTrans <span class="op">=</span> <span class="va">param_pTrans</span>,
                             timeDep.pTrans<span class="op">=</span><span class="cn">FALSE</span>,
                             prefix.host<span class="op">=</span><span class="st">"H"</span>,
                             print.progress<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Starting the simulation</span>
<span class="co">#&gt; Initializing ...</span>
<span class="co">#&gt;  running ...</span>
<span class="co">#&gt; done. </span>
<span class="co">#&gt; The simulation has run for 40 units of time and a total of 111 hosts have been infected.</span></code></pre></div>
<p>Once the simulation has finished, it reports the number of time units for which the simulation has run (40), and the maximum number of infected hosts (111). Note that the simulation has stopped here before reaching <code>length.sim</code> as it has crossed the <code>max.infected</code> threshold set at 100.</p>
</div>
</div>
<div id="dual-host-1" class="section level2">
<h2 class="hasAnchor">
<a href="#dual-host-1" class="anchor"></a>Dual host</h2>
<p>Setting up a dual host simulation is similar to the single host version described above, but each parameter has to be provided for both hosts. Here, we choose for Host A the same parameters as the single / only host above. Host B will have sightly different parameters:</p>
<div id="pexit-b" class="section level3">
<h3 class="hasAnchor">
<a href="#pexit-b" class="anchor"></a>pExit.B</h3>
<p>For <code>pExit.B</code>, we choose a value that depends on the “absolute” time of the simulation, for example cyclic climatic conditions (temperature). In that case, the function’s arguments should be <code>t</code> and <code>prestime</code> (the “absolute” time of the simulation), in that order:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_Exit_fctB</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">prestime</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">prestime</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">16</span><span class="op">}</span> <span class="co">#for a periodic function</span></code></pre></div>
<p>The values of <code>pExit.B</code> across the “absolute time” of the simulation will be the following:</p>
<p><img src="none_files/figure-html/pExit2-dual-1.png" width="700"></p>
<p>Since <code>pExit.B</code> is dependent on the simulation’s absolute time, do not forget to set <code>timeDep.pExit.B</code> to <code>TRUE</code>. Since there are no individual-based parameters, <code>param.pExit.B=NA</code>.</p>
</div>
<div id="ncontact-b" class="section level3">
<h3 class="hasAnchor">
<a href="#ncontact-b" class="anchor"></a>nContact.B</h3>
<p>For <code>nContact.B</code>, we choose a constant function that will sample a value out of a provided range of possible values, each with a certain probability:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n_contact_fct.B</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span>,prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>The distribution of <code>nContact.B</code> looks as follows:</p>
<p><img src="none_files/figure-html/nContact2.B-1.png" width="700"></p>
<p>At each time and for each infected host, <code>nContact.B</code> will be drawn anew. Remember that <code>nContact.B</code>, like the other core functions has to be function of <code>t</code>, even if <code>t</code> is not used. Since <code>nContact.B</code> is constant here, there is no use for the “absolute” time of the simulation nor for the individual-based parameters. So <code>param.nContact.B=NA</code>, and <code>timeDep.nContact.B=FALSE</code>.</p>
</div>
<div id="ptrans-b" class="section level3">
<h3 class="hasAnchor">
<a href="#ptrans-b" class="anchor"></a>pTrans.B</h3>
<p>We choose <code>pTrans.B</code> in the form of a Gaussian function. It will reach its maximum value at a certain time point (mean) after initial infection and will subsequently decrease until it reaches 0:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_Trans_fct.B</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">max.time</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">t</span>, mean<span class="op">=</span><span class="va">max.time</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">5</span>
<span class="op">}</span></code></pre></div>
<p>Because each host is different (slightly different biotic and abiotic factors), you can expect each host to exhibit differences in the dynamics of infection, and hence the probability of transmission over time. Thus, <code>max.time</code> will be sampled for each host individually according to a certain distribution. <code>max.time</code> will be sampled from a normal distribution of parameters <span class="math inline">\(mean\)</span> = 5 and <span class="math inline">\(sd\)</span> = 1:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">max.time_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p>Note again that here <code>max.time</code> is a function of <code>x</code> and not <code>t</code> (not a core function but individual-based parameters), and <code>x</code> enters the function as the number of draws to make.</p>
<p>Taken together, the profile for pTrans for a subset of 200 individuals in the population will look as follows:</p>
<p><img src="none_files/figure-html/pTrans3.B-1.png" width="700"></p>
<p>Since <code>pTrans.B</code> is not dependent on the “absolute” time of the simulation, <code>timeDep.pTrans.B=FALSE</code>. However, since we make use of individual-based parameters, we have to provide a <code>param.pTrans</code> as a list of functions. The name of each element of the list should have the same name as the core function (here <code>pTrans.B</code>) uses as argument, as shown here:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">max.time_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>

<span class="va">param_pTrans.B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>max.time<span class="op">=</span><span class="va">max.time_fct</span><span class="op">)</span></code></pre></div>
</div>
<div id="running-1" class="section level3">
<h3 class="hasAnchor">
<a href="#running-1" class="anchor"></a>Running</h3>
<p>Once <code>nosoiSim</code> is set up, you can run the simulation (here the “seed” ensures that you will obtain the same results as in this tutorial):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slequime/nosoi">nosoi</a></span><span class="op">)</span>

<span class="co">#HostA ------------------------------------</span>

<span class="co">#pExit</span>
<span class="va">p_Exit_fct.A</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fl">0.08</span><span class="op">)</span><span class="op">}</span>

<span class="co">#nContact</span>
<span class="va">n_contact_fct.A</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>

<span class="co">#pTrans</span>
<span class="va">p_Trans_fct.A</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">p_max</span>,<span class="va">t_incub</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="fl">0</span><span class="op">}</span>
    <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">t_incub</span><span class="op">)</span><span class="op">{</span><span class="va">p</span><span class="op">=</span><span class="va">p_max</span><span class="op">}</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="op">}</span>
 
<span class="va">t_incub_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">7</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>
<span class="va">p_max_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="va">x</span>,shape1 <span class="op">=</span> <span class="fl">5</span>,shape2<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span>

<span class="va">param_pTrans.A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>p_max<span class="op">=</span><span class="va">p_max_fct</span>,t_incub<span class="op">=</span><span class="va">t_incub_fct</span><span class="op">)</span>

<span class="co">#Host B ------------------------------------</span>

<span class="co">#pExit</span>
<span class="va">p_Exit_fct.B</span>  <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">prestime</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">prestime</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">16</span><span class="op">}</span>

<span class="co">#nContact</span>
<span class="va">n_contact_fct.B</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span>,prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>

<span class="co">#pTrans</span>
<span class="va">p_Trans_fct.B</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">max.time</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">t</span>, mean<span class="op">=</span><span class="va">max.time</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">5</span>
<span class="op">}</span>
 
<span class="va">max.time_fct</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">x</span>,mean <span class="op">=</span> <span class="fl">5</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span>

<span class="va">param_pTrans.B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>max.time<span class="op">=</span><span class="va">max.time_fct</span><span class="op">)</span>

<span class="co"># Starting the simulation ------------------------------------</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">606</span><span class="op">)</span>
<span class="va">SimulationDual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nosoiSim.html">nosoiSim</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"dual"</span>, popStructure<span class="op">=</span><span class="st">"none"</span>,
                           length.sim<span class="op">=</span><span class="fl">100</span>, 
                           max.infected.A<span class="op">=</span><span class="fl">100</span>, 
                           max.infected.B<span class="op">=</span><span class="fl">100</span>, 
                           
                           init.individuals.A<span class="op">=</span><span class="fl">1</span>, 
                           init.individuals.B<span class="op">=</span><span class="fl">0</span>, 
                           
                           nContact.A<span class="op">=</span><span class="va">n_contact_fct.A</span>,
                           param.nContact.A<span class="op">=</span><span class="cn">NA</span>,
                           timeDep.nContact.A<span class="op">=</span><span class="cn">FALSE</span>,
                           pExit.A<span class="op">=</span><span class="va">p_Exit_fct.A</span>,
                           param.pExit.A<span class="op">=</span><span class="cn">NA</span>,
                           timeDep.pExit.A<span class="op">=</span><span class="cn">FALSE</span>,
                           pTrans.A<span class="op">=</span><span class="va">p_Trans_fct.A</span>,
                           param.pTrans.A<span class="op">=</span><span class="va">param_pTrans.A</span>,
                           timeDep.pTrans.A<span class="op">=</span><span class="cn">FALSE</span>,
                           prefix.host.A<span class="op">=</span><span class="st">"H"</span>,
                           
                           nContact.B<span class="op">=</span><span class="va">n_contact_fct.B</span>,
                           param.nContact.B<span class="op">=</span><span class="cn">NA</span>,
                           timeDep.nContact.B<span class="op">=</span><span class="cn">FALSE</span>,
                           pExit.B<span class="op">=</span><span class="va">p_Exit_fct.B</span>,
                           param.pExit.B<span class="op">=</span><span class="cn">NA</span>,
                           timeDep.pExit.B<span class="op">=</span><span class="cn">TRUE</span>,
                           pTrans.B<span class="op">=</span><span class="va">p_Trans_fct.B</span>,
                           param.pTrans.B<span class="op">=</span><span class="va">param_pTrans.B</span>,
                           timeDep.pTrans.B<span class="op">=</span><span class="cn">FALSE</span>,
                           prefix.host.B<span class="op">=</span><span class="st">"V"</span>,
                           
                           print.progress<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Starting the simulation</span>
<span class="co">#&gt; Initializing ... running ...</span>
<span class="co">#&gt; done. </span>
<span class="co">#&gt; The simulation has run for 43 units of time and a total of 101 (A) and 92 (B) hosts have been infected.</span></code></pre></div>
<p>Once the simulation has finished, it reports the number of time units for which the simulation has run (43), and the maximum number of infected hosts A (101) and hosts B (92). Note that the simulation has stopped here before reaching <code>length.sim</code> as it has crossed the <code>max.infected.A</code> threshold set at 100.</p>
</div>
</div>
</div>
<div id="going-further" class="section level1">
<h1 class="hasAnchor">
<a href="#going-further" class="anchor"></a>Going further</h1>
<p>To analyze and visualize your <code>nosoi</code> simulation output, you can have a look on <a href="https://slequime.github.io/nosoi/articles/examples/viz.html">this page</a>.</p>
<p>You may also want to compose a more complex model by adding some structure (e.g. geography) to your simulation. Two tutorials can guide you on how to set up such structured scenarios:</p>
<ul>
<li>
<a href="discrete.html">Spread of a pathogen in a structured (discrete) population of hosts</a>.</li>
<li>
<a href="continuous.html">Spread of a pathogen in a structure (continuous) population of hosts</a>.</li>
</ul>
<p>A practical example using a dual host type of simulation without population structure is also available:</p>
<ul>
<li>
<a href="https://slequime.github.io/nosoi/articles/examples/vector-competence.html">Epidemiological impact of mosquito vector competence</a>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sebastian Lequime, Paul Bastide, Simon Dellicour, Philippe Lemey, Guy Baele.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
